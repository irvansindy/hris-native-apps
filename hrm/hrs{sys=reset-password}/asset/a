/* res.lib/secrypt:IMPCF16-231 */ /* res.lib/secrypt:IMPCF16-231 */ var Sha1={};Sha1.hash=function(h,z,H){z=(typeof z=="undefined")?true:z;if(H==null){H=2}if(z){h=Utf8.encode(h)}var n=[1518500249,1859775393,2400959708,3395469782];h+=String.fromCharCode(128);var x=h.length/4+2;var k=Math.ceil(x/16);var m=new Array(k);for(var A=0;A<k;A++){m[A]=new Array(16);for(var y=0;y<16;y++){m[A][y]=(h.charCodeAt(A*64+y*4)<<24)|(h.charCodeAt(A*64+y*4+1)<<16)|(h.charCodeAt(A*64+y*4+2)<<8)|(h.charCodeAt(A*64+y*4+3))}}m[k-1][14]=((h.length-1)*8)/Math.pow(2,32);m[k-1][14]=Math.floor(m[k-1][14]);m[k-1][15]=((h.length-1)*8)&4294967295;var u=1732584193;var r=4023233417;var q=2562383102;var p=271733878;var o=3285377520;var f=new Array(80);var G,F,E,C,B;for(var A=0;A<k;A++){for(var v=0;v<16;v++){f[v]=m[A][v]}for(var v=16;v<80;v++){f[v]=Sha1.ROTL(f[v-3]^f[v-8]^f[v-14]^f[v-16],1)}G=u;F=r;E=q;C=p;B=o;for(var v=0;v<80;v++){var w=Math.floor(v/20);var g=(Sha1.ROTL(G,5)+Sha1.f(w,F,E,C)+B+n[w]+f[v])&4294967295;B=C;C=E;E=Sha1.ROTL(F,30);F=G;G=g}u=(u+G)&4294967295;r=(r+F)&4294967295;q=(q+E)&4294967295;p=(p+C)&4294967295;o=(o+B)&4294967295}var D=Sha1.toHexStr(u)+Sha1.toHexStr(r)+Sha1.toHexStr(q)+Sha1.toHexStr(p)+Sha1.toHexStr(o);if(H==1){D=D.toLowerCase()}else{if(H==2){D=D.toUpperCase()}}return D};Sha1.f=function(b,a,d,c){switch(b){case 0:return(a&d)^(~a&c);case 1:return a^d^c;case 2:return(a&d)^(a&c)^(d&c);case 3:return a^d^c}};Sha1.ROTL=function(a,b){return(a<<b)|(a>>>(32-b))};Sha1.toHexStr=function(d){var c="",a;for(var b=7;b>=0;b--){a=(d>>>(b*4))&15;c+=a.toString(16)}return c};Sha1.getHash=function(f,c,d){if(d==null){d=7}else{if(d==0){var e=Sha1.hash(f,true);var a=[e.substr(0,4),e.substr(4,e.length-8),e.substr(e.length-4,4)];e=a[0].split("").reverse().join("")+a[1].split("").reverse().join("")+a[2].split("").reverse().join("");return e}}if(c==null){c=f}else{if(c.search(":")>0){c=c.split(":")[0]}}c="5unf15h"+c+"D4740N";c=c.split("").reverse().join("");var e=Sha1.hash(f+c,true);for(var b=1;b<d;b++){e=Sha1.hash(e+c,true)}return e};var Utf8={};Utf8.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(192|d>>6,128|d&63)});b=b.replace(/[\u0800-\uffff]/g,function(e){var d=e.charCodeAt(0);return String.fromCharCode(224|d>>12,128|d>>6&63,128|d&63)});return b};Utf8.decode=function(b){var a=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var d=((e.charCodeAt(0)&15)<<12)|((e.charCodeAt(1)&63)<<6)|(e.charCodeAt(2)&63);return String.fromCharCode(d)});a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var d=(e.charCodeAt(0)&31)<<6|e.charCodeAt(1)&63;return String.fromCharCode(d)});return a}; /* res.helper:IMPCF16-231 */ /* res.helper:IMPCF16-231 */ var uag=navigator.userAgent;var bwtype=(uag.search(/Firefox/i)>=0?"FF":(uag.search(/MSIE/i)>=0?"IE":(uag.search(/Chrome/i)>=0?"Chrome":(uag.search(/Opera/i)>=0?"Opera":(uag.search(/Safari/i)>=0?"Safari":"Other")))));var offsetX=0;var offsetY=0;var unicodecharsetregex="[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]+";if(typeof(pstitle)==="undefined"){var pstitle=""}String.prototype.ltrim=function(){return this.replace(/^\s\s*/g,"")};String.prototype.rtrim=function(){return this.replace(/\s\s*$/g,"")};String.prototype.trim=function(){return this.ltrim(this.rtrim)};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c){if(this===void 0||this===null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var e=0;if(arguments.length>0){e=Number(arguments[1]);if(e!==e){e=0}else{if(e!==0&&e!==(1/0)&&e!==-(1/0)){e=(e>0||-1)*Math.floor(Math.abs(e))}}}if(e>=a){return -1}var b=e>=0?e:Math.max(a-Math.abs(e),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}}function typeObj(a){return Object.prototype.toString.call(a).match(/^\[object (.*)\]$/)[1]}var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,c=function(f,e){f=String(f);e=e||2;while(f.length<e){f="0"+f}return f};return function(i,v,q){var g=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){v=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i)){throw SyntaxError("invalid date")}v=String(g.masks[v]||v||g.masks["default"]);if(v.slice(0,4)=="UTC:"){v=v.slice(4);q=true}var t=q?"getUTC":"get",l=i[t+"Date"](),e=i[t+"Day"](),j=i[t+"Month"](),p=i[t+"FullYear"](),r=i[t+"Hours"](),k=i[t+"Minutes"](),u=i[t+"Seconds"](),n=i[t+"Milliseconds"](),f=q?0:i.getTimezoneOffset(),h={d:l,dd:c(l),ddd:g.i18n.dayNames[e],dddd:g.i18n.dayNames[e+7],m:j+1,mm:c(j+1),mmm:g.i18n.monthNames[j],mmmm:g.i18n.monthNames[j+12],yy:String(p).slice(2),yyyy:p,h:r%12||12,hh:c(r%12||12),H:r,HH:c(r),M:k,MM:c(k),s:u,ss:c(u),l:c(n,3),L:c(n>99?Math.round(n/10):n),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:q?"UTC":(String(i).match(b)||[""]).pop().replace(d,""),o:(f>0?"-":"+")+c(Math.floor(Math.abs(f)/60)*100+Math.abs(f)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return v.replace(a,function(m){return m in h?h[m]:m.slice(1,m.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(a,b){return dateFormat(this,a,b)};Date.prototype.add=function(a,d){d=parseInt(d);var e=new Date(this.getTime());var f=e.getDate();if(!a||d==0){return e}var b=a.toLowerCase();switch(b){case"ms":e.setMilliseconds(e.getMilliseconds()+d);break;case"s":e.setSeconds(e.getSeconds()+d);break;case"n":e.setMinutes(e.getMinutes()+d);break;case"h":e.setHours(e.getHours()+d);break;case"d":e.setDate(e.getDate()+d);break;case"m":e.setMonth(e.getMonth()+d);break;case"y":e.setFullYear(e.getFullYear()+d);break}var c=e.getDate();if((b=="m"||b=="y")&&c!=f){e.setDate(e.getDate()-(c));return e}else{return e}};function daysInMonth(b,a){return 32-new Date(a,b,32).getDate()}function newStruct(c,d){if(d==null){d=","}var c=c.split(d);var b=c.length;function a(){for(var e=0;e<b;e++){this[c[e]]=arguments[e]}}return a}function $sf(d,b,a){var c=null;if(a){if(b!=null){var c=b.document.getElementsByClassName(d)}else{var c=document.getElementsByClassName(d)}if(c==null){c=top.document.getElementsByClassName(d)}}if(c==null){if(b!=null){var c=b.document.getElementById(d)}else{var c=document.getElementById(d)}if(c==null){c=top.document.getElementById(d)}}return c}function arrid(h,f,d){var g=$sf(h,f,d);if(g){if(isArray(g)){return g}else{var a=[g];var c=g.parentNode;var e=false;for(var b=0;b<c.childNodes.length;b++){if(c.childNodes[b].id){if(c.childNodes[b].id==h){if(e){e=true}else{a.push(c.childNodes[b])}}}}return a}}}function showHide(c,a,b){if(typeof(c)=="string"){c=$sf(c)}if(c==null){return c}if(a==null){a=(c.style.display=="none")}c.style.display=(a?"":"none");if(b){b()}return c}function ltrim(a){return a.replace(/^\s\s*/g,"")}function rtrim(a){return a.replace(/\s\s*$/g,"")}function trim(a){return ltrim(rtrim(a))}function padding(b,a,e,c){if(e==null){e="0"}b=""+b;var d=new Array(a-b.length+1).join(e);if(c==1){d=b+d}else{d+=b}return d}function getLookUp(a,k,b){if(k==""||k==null){return""}if(b==null){b=","}var l=new Array();var f=k.split(",");if(typeof(a)=="string"){var g=a.split(b);for(var c=0;c<f.length;c++){var e=""+f[c];for(var d=0;d<g.length;d++){var h=g[d].split("=");if((""+h[0]).toLowerCase()==e.toLowerCase()){l.push(h.length==1?e:(""+h[1]));break}}}}else{if(a.optvalue){for(var c=0;c<f.length;c++){var e=""+f[c];for(var d=0;d<a.optvalue.length;d++){if((""+a.optvalue[d]).toLowerCase()==e.toLowerCase()){l.push(a.opttext[d]);break}}}}else{l[0]=k}}return l.join(",")}function eschar(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function isEmpty(a){return(a.trim().length==0)}function isInteger(a){return(a.search(/^\s*(\+|-)?\d+\s*$/)>=0)}function isFloat(a){return(a.search(/^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/)>=0)}function isMoney(a){return(a.search(/^\s*(\+|-)?((\d+(\.\d\d)?)|(\.\d\d))\s*$/)>=0)}function isEmail(a){return(a.search(/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/)>=0)}function getDigit(a){return a.replace(/[^\d]/g,"")}function validateString(a,c){if(c==null){c=0}var b=new RegExp("[^-a-z_0-9/ &.'@()\"[]]","gi");if(a==""){return c}else{return(a.match(b)==null)}}function validateRange(a,c){if(c==null){c=0}var b=new RegExp("[^-<>=0-9., ]","gi");if(a==""){return c}else{return(a.match(b)==null)}}function validateDateRange(a,c){if(c==null){c=0}var b=new RegExp("[^-<>=0-9., /]","gi");var d=a.replace(/[^-0-9., \/]/gi,"");if(d.length<8){return c}else{return(a.match(b)==null)}}function isArray(a){if(Array.isArray){return Array.isArray(a)}if(a==null){return false}else{return a.constructor==Array}}function isBoolean(a){if(a.constructor==Boolean){return true}return false}function IsValidTime(c){var a=/^(\d{1,2}):(\d{2})(:(\d{2}))?(\s?(AM|am|PM|pm))?$/;var b=c.match(a);if(b==null){return false}hour=b[1];minute=b[2];second=b[4];ampm=b[6];if(second==""){second=null}if(ampm==""){ampm=null}if(hour<0||hour>23){alert("Hour must be between 0 and 23.");return false}if(minute<0||minute>59){alert("Minute must be between 0 and 59.");return false}if(second!=null&&(second<0||second>59)){alert("Second must be between 0 and 59.");return false}return true}function isDate(d,j,b){if(d.length<8||d.length>10){if(d.length>10&&d.match(/(,|-)/g)==null){alert("Please enter valid date.")}return false}var a=/^(\d{1,2})(\/|-|.)(\d{1,2})(\/|-|.)(\d{4})$/;var h=d.match(a);var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]/g,c={d:"(?:[1-9]|[12]\\d|3[01])",dd:"(?:0[1-9]|[12]\\d|3[01])",ddd:"(?:"+dateFormat.i18n.dayNames.slice(0,7).join("|")+")",dddd:"(?:"+dateFormat.i18n.dayNames.slice(7).join("|")+")",m:"(?:[1-9]|1[0-2])",mm:"(?:0[1-9]|1[0-2])",mmm:"(?:"+dateFormat.i18n.monthNames.slice(0,12).join("|")+")",mmmm:"(?:"+dateFormat.i18n.monthNames.slice(12).join("|")+")",yy:"\\d{2}",yyyy:"\\d{4}",h:"(?:[1-9]|1[0-2])",hh:"(?:0[1-9]|1[0-2])",H:"(?:[1-9]|1\\d|2[0-4])",HH:"(?:0[1-9]|1\\d|2[0-4])",M:"(?:\\d|[1-5]\\d|60)",MM:"(?:[0-5]\\d|60)",s:"(?:\\d|[1-5]\\d|60)",ss:"(?:[0-5]\\d|60)",l:"\\d{3}",L:"\\d{2}",t:"[ap]",tt:"[ap]m",T:"[AP]",TT:"[AP]M",Z:"(?:[PMCEA][SDP]T|(?:GMT|UTC)(?:[-+]\\d{4})?)",o:"[-+]\\d{4}",S:"(?:th|st|nd|rd)"},i=function(k){return k.replace(/[[\]{}()*+?\\^$|]/g,"\\$&")};var g=new RegExp("^"+i(j).replace(e,function(k){if(k.search(/d/i)>=0){day=d.substr(j.indexOf(k),2)}else{if(k.search(/m/i)>=0){month=d.substr(j.indexOf(k),2)}else{if(k.search(/y/i)>=0){year=d.substr(j.indexOf(k),4)}}}return c[k]})+"$").test(d);if(!g){if(b!="validateForm"){alert("Please enter valid date or enter date as "+j+".")}return false}else{}if(month<1||month>12){alert("Month must be between 1 and 12.");return false}if(day<1||day>31){alert("Day must be between 1 and 31.");return false}if((month==4||month==6||month==9||month==11)&&day==31){alert("Month "+month+" doesn't have 31 days!");return false}if(month==2){var f=(year%4==0&&(year%100!=0||year%400==0));if(day>29||(day==29&&!f)){alert("February "+year+" doesn't have "+day+" days!");return false}}if(year<1753){alert("Please insert Year more than 1753");return false}return true}function dateFormatMask(b,d,c){if(d==null){d="mm/dd/yyyy"}if(c==null){c="mm/dd/yyyy"}var a=c;a=a.replace(/dd/i,b.substr(d.indexOf("dd"),2));a=a.replace(/mm/i,b.substr(d.indexOf("mm"),2));a=a.replace(/yyyy/i,b.substr(d.indexOf("yyyy"),4));if(a!=c){return a}else{return false}}function stringToDateJS(b,g,h,f,a){if(g==null){g="mm/dd/yyyy"}if(h==null){h="mm/dd/yyyy"}if(!isDate(b,g,a)){return false}var e=h;var i=b.substr(g.indexOf("dd"),2);var c=b.substr(g.indexOf("mm"),2);var d=b.substr(g.indexOf("yyyy"),4);switch(f){case"gregorian":break;case"buddhist":d=parseInt(d)-543;break}e=e.replace(/dd/i,i);e=e.replace(/mm/i,c);e=e.replace(/yyyy/i,d);if(e!=h){return e}else{return false}}function dateToStringJS(c,f,e,d){if(f==null){f="mm/dd/yyyy"}if(e==null){e="mm/dd/yyyy"}var b=e;var a=c.substr(f.indexOf("dd"),2);var g=c.substr(f.indexOf("mm"),2);var h=c.substr(f.indexOf("yyyy"),4);switch(d){case"gregorian":break;case"buddhist":h=parseInt(h)+543;break}b=b.replace(/dd/i,a);b=b.replace(/mm/i,g);b=b.replace(/yyyy/i,h);if(b!=e){return b}else{return false}}function date_compare(start,end,notRefresh,caller){var start_date=stringToDateJS(start.value,date_input_mask,null,calendar_format,caller);if(start_date==false){return"0"}var end_date=stringToDateJS(end.value,date_input_mask,null,calendar_format,caller);if(end_date==false){return"1"}start_date=Date.parse(start_date);end_date=Date.parse(end_date);if(eval(end_date-start_date)<0){return"2"}return true}function tsformat(a){return"{ts '"+a.format("yyyy-mm-dd HH:MM:ss")+"'}"}function setMoneyFormat(f,d,b,h,g){var c="";var i="0";if(f==null){f=window.event}if(h){var a=0}else{if(b!=null||b==""){var a=getLookUp(arrMONEY,b,"|")}else{var a=decimal_count}}try{formodified(d)}catch(f){ismodif=true}if(d.value.length>=17){d.value=d.value.substring(0,16)}if(d.value.match(/\D/)){i=d.value.replace(/[^-0-9.]/g,"")}else{i=d.value}i=moneyFormat(i,c,a,thousand_separator,decimal_separator);if(i==null||i==""||i=="NaN"||i=="Infinity"){i=moneyFormat(0,c,a,thousand_separator,decimal_separator)}if(d.value.length>3){showTip(d,i,1,null,50)}else{destroyTip()}}function setMoneyFormatOnBlur(h,d,i,b,j){var c="";var g="0";if(h==null){h=window.event}if(i!=null||i==""){var a=getLookUp(arrMONEY,i,"|")}else{var a=decimal_count}if(b){var a=0}if(d.value.length>=17){d.value=d.value.substring(0,16)}if(d.value.match(/\D/)){d.value=d.value.replace(/[^-0-9.]/g,"")}var k=d.value.split(".");var f=0;if(k.length>1){f=k[1].length}d.value=moneyFormat(d.value,c,f,",",".");if(d.value==null||d.value==""||d.value=="NaN"||d.value=="Infinity"){d.value=moneyFormat(0,c,f,"",".")}if(j){return d.value}}function setNumericFormatOnBlur(c,b){if(c==null){c=window.event}if(b.value.length>=17){b.value=b.value.substring(0,16)}if(b.value.match(/\D/)){b.value=b.value.replace(/[^-0-9.]/g,"")}var d=b.value.split(".");var a=0;if(d.length>1){a=d[1].length}}function setTimeFormat(b,a){if(b==null){b=window.event}if(b.shiftKey||b.ctrlKey||b.keyCode==16||b.keyCode==9){return false}if(inputDigitsOnly(b)){if(b.type!="keypress"){if(a.value.match(/\D/)){a.value=a.value.replace(/\D/g,"")}}if(trim(a.value).length<=4){if(a.value.search(/:/i)>-1){a.value=a.value.replace(":","")}}if(trim(a.value).length==4){if(a.value.search(/:/i)<0){if(a.value<2359){if(a.value.substring(0,2)<=23){if(a.value.substring(2,3)<=5){a.value=a.value.substring(0,2)+":"+a.value.substring(2,4)}else{a.value=a.value.substring(0,2)+":00"}}else{if(a.value.substring(2,3)<=5){a.value="00:"+a.value.substring(2,4)}else{a.value="00:00"}}}else{if(a.value.substring(0,2)<=23){if(a.value.substring(2,3)<=5){a.value=a.value.substring(0,2)+":"+a.value.substring(2,4)}else{a.value=a.value.substring(0,2)+":00"}}else{if(a.value.substring(2,3)<=5){a.value="00:"+a.value.substring(2,4)}else{a.value="00:00"}}}}}}else{if(b.type!="keypress"){if(a.value.match(/\D/)){a.value=a.value.replace(/[^0-9:]/g,"")}if(trim(a.value).length<=4){a.value=a.value.replace(/\D/g,"")}if(b.type=="blur"){if(trim(a.value).length==1){a.value="0"+a.value+":00"}if(trim(a.value).length==2){if(a.value<=23){a.value=a.value+":00"}else{if(a.value<=59){a.value="00:"+a.value}else{a.value="00:00"}}}if(trim(a.value).length==3){if(a.value<=959){if(a.value.substring(1,2)<=5){a.value="0"+a.value.substring(0,1)+":"+a.value.substring(1,3)}else{a.value="0"+a.value.substring(0,1)+":00"}}else{a.value="0"+a.value.substring(0,1)+":00"}}}}}}function inputDigitsOnly(d){var b,c=0,a=d?d:event;c=(a.type=="keypress"?a.charCode!=null?a.charCode:a.which!=null?a.which:a.keyCode:a.keyCode!=null?a.keyCode:a.which);if(c==0){b="SPECIAL KEY"}else{b=String.fromCharCode(c)}if(b.match(/\d|[\b]|SPECIAL/)){return true}if(a.altKey||a.ctrlKey||c<28){return true}if(a.preventDefault){a.preventDefault()}a.returnValue=false;return false}function popForm(g,f,d,e,b,c){if(d==null){d="popPrint"}var a=popWindow("",d,e,b,c);g.target=a;if(f!=""){g.action=f}g.submit()}function popPrint(j,f,e,b,l){if(j==null){return}if(f==null){f="popPrint"}if(e==null){e="760"}if(b==null){b="600"}if(l==null){l="location=no,scrollbars=yes,status=no,toolbar=no,resizable=yes,menubar=no"}var c="";if(lastLink!=null){if(lastLink!=""){var c=lastLink+"&reload=1"}}if(c==""){c=mLink}var a=j;if(c!=""){var k=c.split("?");var g=k[1].split("&");for(var d=0;d<g.length;d++){if(g[d].split("=")[0]!="ofid"){if(!a.indexOf(g[d])){a+="&"+g[d]}}}}if(a!=""){if(a.substr(0,1)=="&"){a="?"+a}var h=popWindow(a,f,e,b,l)}}function redir(b,a){if(a==null){a=window}if(b==null){return}if(pstitle!=""&&b!=""){if(b.search("&origin=")<0){b+="&origin="+encodeURIComponent(pstitle)}}a.location=b}function jsnow(){var a=new Date();return a.getTime()}function popWindow(theURL,theName,theWidth,theHeight,theOption){if(theURL==null){return}if(pstitle!=""&&theURL!=""){if(theURL.search("&origin=")<0){theURL+="&origin="+encodeURIComponent(pstitle)}}if(theURL.search(/&lreqts=/gi)<0&&theURL!=""){theURL+="&lreqts="+jsnow()}if(theName==null){theName="popWin"}if(theWidth==null){theWidth="500"}if(theHeight==null){theHeight="400"}if(theWidth.toString().search("%")>0){theWidth=(screen.width*eval(theWidth.replace("%","/100")))}if(theHeight.toString().search("%")>0){theHeight=(screen.height*eval(theHeight.replace("%","/100")))}if(theOption==null){theOption="location=no,scrollbars=no,status=no,toolbar=no,resizable=yes,menubar=no"}if(theOption.search("width=")<0){theOption+=",width="+theWidth}if(theOption.search("height=")<0){theOption+=",height="+theHeight}if(theOption.search("left=")<0){theOption+=",left="+(screen.width-theWidth)/2}if(theOption.search("top=")<0){theOption+=",top="+(screen.height-theHeight)/2}var mywin=window.open(theURL,theName,theOption);if(mywin!=null){if(screen.height>theHeight&&screen.width>theWidth){mywin.moveTo((screen.width-theWidth)/2,(screen.height-theHeight)/2)}mywin.focus()}return}function moneyFormat(g,f,a,d,c){if(f==null||f==""||typeof(f)=="undefined"){f=""}if(a==null||a==""||typeof(a)=="undefined"){g=parseFloat(g).toFixed(0)}else{mult=Math.pow(10,a);g=Math.round(g*mult)/mult;g=g.toString();g=parseFloat(g).toFixed(a)}if(d==null||typeof(d)=="undefined"){d=","}if(c==null||typeof(c)=="undefined"){c="."}var e=new RegExp("(-?[0-9]+)([0-9]{3})");var h=g+"";var b=[];b=h.split(".");h=b[0];if(d!=""){while(e.test(h)){h=h.replace(e,"$1"+d+"$2")}}if(b.length>1){h=h+c+b[1]}return(f+h)}function luhn(a){var c=0;var b;var d=getDigit(a);for(b=d.length-2;b>=0;b-=2){c+=Array(0,2,4,6,8,1,3,5,7,9)[parseInt(d.charAt(b),10)]}for(b=d.length-1;b>=0;b-=2){c+=parseInt(d.charAt(b),10)}return(c%10)==0}function isValid_code(c,b){if(c.length==0){return false}var a=new RegExp("[^a-zA-Z_0-9]","g");if(b.length>0){if(b.search("-")>0){b="-"+b.replace("-","")}a=new RegExp("[^"+unescape(b)+"a-zA-Z_0-9]","g")}if(unescape(c).search(a)<0){return true}return false}function isValid_codenumber(c,b){var a=new RegExp("[^- .0-9]","g");if(b.length>0){a=new RegExp("[^- .0-9"+unescape(b)+"]","g")}if(unescape(c).search(a)<0){return true}return false}function isValid_codename(c,b){if(c.length==0){return false}var a="- .,()'a-zA-Z_0-9";b=b+unicodecharsetregex;if(b.length>0){a=a+unescape(b)}console.log(a+"|"+c.search(a));a=new RegExp("[^"+a+"]","g");if(unescape(c).search(a)<0){return true}return false}function isValid_email(b,a){return isEmail(unescape(b))}function isValid_age(f,a){var e=new Date(unescape(f));var d=new Date();var c=unescape(a);var g=c.substr(c.length-1,1);c=parseInt(c.substr(0,c.length-1));var b=e.add(g,c);return(b<=d)}var creditCardList=[["amex","34",15],["amex","37",15],["disc","6011",16],["mc","51",16],["mc","52",16],["mc","53",16],["mc","54",16],["mc","55",16],["visa","4",13],["visa","4",16]];function isValidCC(c,b){var d=getDigit(b);if(luhn(d)){for(var a in creditCardList){if(creditCardList[a][0]==(c.toLowerCase())){if(d.indexOf(creditCardList[a][1])==0){if(creditCardList[a][2]==d.length){return true}}}}}return false}function isCreditCard(b){var c=getDigit(b);if(c.length>2){for(var a in creditCardList){if(isValidCC(creditCardList[a][0],c)){return creditCardList[a][0]}}firstdig=c.substring(0,1);seconddig=c.substring(1,2);if((c.length==14)&&(firstdig==3)&&((seconddig==0)||(seconddig==6)||(seconddig==8))){return"dclub"}}return false}function isCtrlKey(a){return(a==36||a==35||a==9||a==39||a==37||a==16||a==17||a==13||a==33||a==34||a==18||a==38||a==40)}function getElementPos_old(a){var b=curtop=0;if(a.offsetParent){do{b+=parseInt(a.offsetLeft)-parseInt(a.scrollLeft);curtop+=parseInt(a.offsetTop)-parseInt(a.scrollTop)}while(a=a.offsetParent);return[b,curtop]}else{return null}}function getElementPos(b){var a=b;var c=curtop=0;if(b.offsetParent){if(document.getElementById||document.all){do{c+=parseInt(b.offsetLeft)-parseInt(b.scrollLeft);curtop+=parseInt(b.offsetTop)-parseInt(b.scrollTop);b=b.offsetParent;a=a.parentNode;while(a!=b){c-=parseInt(a.scrollLeft);curtop-=parseInt(a.scrollTop);a=a.parentNode}}while(b.offsetParent)}else{if(document.layers){curtop+=b.y;c+=b.x}}return[c,curtop]}else{return null}}function getParentTag(a,b){if(a.parentNode){b=b.toUpperCase();while(a!=null&&a.tagName&&a.tagName.toUpperCase()!=b&&a.parentNode){a=a.parentNode}if(a==null){return null}else{if(a.tagName&&a.tagName.toUpperCase()==b){return a}else{return null}}}else{return null}}function setCookie(g,f,e,b,a,d){var c=escape(g)+"="+escape(f);c+=(e?"; EXPIRES="+e.toGMTString():"");c+=(b?"; PATH="+b:"");c+=(a?"; DOMAIN="+a:"");c+=(d?"; SECURE":"");document.cookie=c}function getCookie(d){var c=null;if(document.cookie){var a=document.cookie.split((escape(d)+"="));if(a.length>=2){var b=a[1].split(";");c=unescape(encodeURI(b[0]))}}return c}function deleteCookie(c,a){var b=getCookie(c);if(b){setCookie(c,b,(new Date(1)),a)}}function printpr(){var a=7;var c=1;var b="<OBJECT ID='WebBrowser1' WIDTH=0 HEIGHT=0 CLASSID='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2'></OBJECT>";document.body.insertAdjacentHTML("beforeEnd",b);WebBrowser1.ExecWB(a,c);WebBrowser1.outerHTML=""}function printpage(a,c){if(a!=null){var b=getParentTag(a,"DIV");if(b!=null){showHide(b);setTimeout("showHide('"+b.id+"',true);",1000)}}if(c==null){c=false}if(bwtype=="IE"&&!c){printpr()}else{window.print()}}function expTree(f,m){var l=f.parentNode.parentNode;if(l.tagName=="TD"){l=l.parentNode}var a=l.id.split("_");a=a[a.length-1];var d=","+l.lang+","+a+",";var n=l.parentNode;var k=false;var j=(f.src.search("exp")>=0);if(j){var h="";f.src=f.src.replace("exp","clp")}else{var h="none";f.src=f.src.replace("clp","exp")}var b=null;for(var e=0;e<n.childNodes.length;e++){var c=n.childNodes[e];if(m){b=$sf(m+"_"+c.id.split("_")[1])}if(c.id){if(c.id==l.id){k=true}else{if(k){if((","+c.lang+",").search(d)>=0){if(","+c.lang+","==d){c.style.display=h;if(b){b.style.display=h}if(h==""){var g=c.childNodes[0].childNodes[0];if(g.tagName=="IMG"){g.src=g.src.replace("clp","exp")}else{if(g.childNodes.length){g=g.childNodes[0];if(g.tagName){if(g.tagName=="IMG"){g.src=g.src.replace("clp","exp")}}}}}}else{c.style.display="none";if(b){b.style.display="none"}}}else{if(c.lang!=""){k=false;break}else{c.style.display=(k?"none":"");if(b){b.style.display=(k?"none":"")}}}}}}}}function inpselect(b){var a=b.value;if(a!=""){if(a.substr(0,1)=="["||a.substr(a.length,1)=="]"){b.select()}}}function getInput(frm,theinp,turl,optlink){var alstr=turl;var tinp=theinp.split("&");for(var n=0;n<tinp.length;n++){var vstr="";var vinp=tinp[n].split("=");var obj=$sf(vinp[1]);if(obj.type.toUpperCase()=="CHECKBOX"||obj.type.toUpperCase()=="RADIO"){var obj=eval("frm."+obj.id);if(obj.length){var arrStr=[];for(var i=0;i<obj.length;i++){if(obj[i].checked){arrStr.push(obj[i].value)}}vstr=arrStr.join(",")}else{if(obj.checked){vstr=obj.value}}}else{if(obj.type.toUpperCase()=="SELECT-ONE"||obj.type.toUpperCase()=="SELECT"){var obj=eval("frm."+obj.id);if(obj.length){var arrStr=[];for(var i=0;i<obj.length;i++){if(/^\[object (RadioNodeList|NodeList|HTMLCollection|Object)\]$/.test(Object.prototype.toString.call(obj))){if(obj[i].selectedIndex&&obj[i].selectedIndex>0){arrStr.push(obj[i].value)}}else{if(obj.options[i].selected){arrStr.push(obj.options[i].value)}}}vstr=arrStr.join(",")}else{if(obj.selectedIndex){vstr=obj.value}}}else{if(obj.value){vstr=obj.value}}}if(vstr!=""&&optlink&&alstr.search("@")>=0){var vopt=optlink.split(",");for(var i=0;i<vopt.length;i++){dopt=vopt[i].split("=");if(dopt[0]==vstr){alstr=alstr.replace("@",dopt[1].replace(/~/g,"="));break}}}alstr+="&"+vinp[0]+"="+vstr}location=alstr}function getHeight(a){if(typeof(a)==="string"){a=$sf(a)}return a.offsetHeight}function getWidth(a){if(typeof(a)==="string"){a=$sf(a)}if(a){return a.offsetWidth}else{return 0}}if(!window.console){window.console=({log:function(){},debug:function(){},info:function(){},warn:function(){},exception:function(){},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},clear:function(){},time:function(){},timeEnd:function(){},timeStamp:function(){},table:function(){},error:function(){}})}function logthis(){if(console){if(console.log){if(arguments.length>1){console.log(arguments)}else{console.log(arguments[0])}}}}function tracethis(){if(console){if(console.trace){if(arguments.length>1){console.trace(arguments)}else{console.trace(arguments[0])}}}}function debugthis(){if(console){if(console.debug){if(arguments.length>1){console.debug(arguments)}else{console.debug(arguments[0])}}}}function delConfig(a){location=a}function zoomTo(e,c,f){if(bwtype=="FF"){if(typeof(e)==="string"){e=$sf(e)}if(e.style.transform==""){e.style.transform="scale(1)"}var a=e.style.transform.match(/scale\(([^)]+)\)/)[1];if(f==100){a=1}else{a=parseInt(f)/100}e.style.transform="scale("+a+")";if(c!=null){if(typeof(c)==="string"){arrExclthis=c.split(",");for(var b=arrExclthis.length-1;b>=0;b--){if(arrExclthis[b]=="control"){$sf(arrExclthis[b])}else{if(typeof(arrExclthis[b])==="string"){c=window.frames[0].$sf(arrExclthis[b])}}if(c.style.transform==""){c.style.transform="scale(1)"}var d=c.style.transform.match(/scale\(([^)]+)\)/)[1];if(f==100){d=1}else{d=100/parseInt(f)}c.style.transform="scale("+d+")"}}else{if(typeof(c)==="object"){if(c.style.transform==""){c.style.transform="scale(1)"}var d=c.style.transform.match(/scale\(([^)]+)\)/)[1];if(f==100){d=1}else{d=100/parseInt(f)}c.style.transform="scale("+d+")"}}}}else{if(bwtype=="IE"){if(typeof(e)==="string"){e=$sf(e)}if(e.style.zoom==""){e.style.zoom="1"}var a=e.style.zoom;if(f==100){a=1}else{a=parseInt(f)/100}e.style.zoom=a;if(c!=null){if(typeof(c)==="string"){arrExclthis=c.split(",");for(var b=arrExclthis.length-1;b>=0;b--){if(arrExclthis[b]=="control"){$sf(arrExclthis[b])}else{if(typeof(arrExclthis[b])==="string"){c=window.frames[0].$sf(arrExclthis[b])}}if(c.style.zoom==""){c.style.zoom="1"}var d=c.style.zoom;if(f==100){d=1}else{d=100/parseInt(f)}c.style.zoom=d}}else{if(typeof(c)==="object"){if(c.style.zoom==""){c.style.zoom="1"}var d=c.style.zoom;if(f==100){d=1}else{d=100/parseInt(f)}c.style.zoom=d}}}}else{if(bwtype=="Chrome"){if(typeof(e)==="string"){e=$sf(e)}if(e.getAttribute("style")==null||e.getAttribute("style").match(/scale\(([^)]+)\)/)==null){e.setAttribute("style","-webkit-transform: scale(1);")}var a=e.getAttribute("style").match(/scale\(([^)]+)\)/)[1];if(f==100){a=1}else{a=parseInt(f)/100}e.setAttribute("style",e.getAttribute("style").replace(/scale\(([^)]+)\)/,"scale("+a+")"));if(c!=null){if(typeof(c)==="string"){arrExclthis=c.split(",");for(var b=arrExclthis.length-1;b>=0;b--){if(typeof(arrExclthis[b])==="string"){c=window.frames[0].$sf(arrExclthis[b])}if(c.getAttribute("style").match(/scale\(([^)]+)\)/)==null){c.setAttribute("style",c.getAttribute("style")+"-webkit-transform: scale(1)")}var d=c.getAttribute("style").match(/scale\(([^)]+)\)/)[1];if(f==100){d=1}else{d=100/parseInt(f)}c.setAttribute("style",c.getAttribute("style").replace(/scale\(([^)]+)\)/,"scale("+d+")"))}}else{if(typeof(c)==="object"){if(c.getAttribute("style").match(/scale\(([^)]+)\)/)==null){c.setAttribute("style",c.getAttribute("style")+"-webkit-transform: scale(1)")}var d=c.getAttribute("style").match(/scale\(([^)]+)\)/)[1];if(f==100){d=1}else{d=100/parseInt(f)}c.setAttribute("style",c.getAttribute("style").replace(/scale\(([^)]+)\)/,"scale("+d+")"))}}}}}}}function repositionControl(){var a=$sf("control");window.body.ctr.style.top=window.body.scrollTop+"px";a.style.left=window.body.scrollLeft+"px"}function getCaret(a){el=$sf(a);if(el.selectionStart){return el.selectionStart}else{if(document.selection){el.focus();var c=document.selection.createRange();if(c==null){return 0}var b=el.createTextRange(),d=b.duplicate();b.moveToBookmark(c.getBookmark());d.setEndPoint("EndToStart",b);return d.text.length}}return 0}function xinspect(e,b){if(typeof b=="undefined"){b=""}if(b.length>50){return"[MAX ITERATIONS]"}var c=[];for(var d in e){var a=typeof e[d];c.push(b+'"'+d+'" ('+a+") => "+(a=="object"?"object:"+xinspect(e[d],b+"  "):e[d]+""))}return c.join(b+"\n")}function setTextFocus(b,a){if(typeof(b)==="string"){b=$sf(b)}if(b.value==a){b.value="";b.style.color="black"}}function setTextBlur(b,a){if(typeof(b)==="string"){b=$sf(b)}if(b.value==""){b.value=a;b.style.color=""}}function addBGColor(b){var c=document.getElementsByTagName("div");for(var a=0;a<c.length;a++){if(c[a].className==b){c[a].style.backgroundColor="#ffffaa"}}}function clearBGColor(b){var c=document.getElementsByTagName("div");for(var a=0;a<c.length;a++){if(c[a].className==b){c[a].style.backgroundColor=""}}}function checkEmpty(a){var b=document.getElementById(a);if(b.value==""){alert("The field cannot be empty.");b.select();b.focus();return false}else{return true}}function checkEmpStatus(d){var c=document.getElementsByName(d);var b=0;for(var a=0;a<c.length;a++){if(c[a].checked==true){b++}}if(b<1){alert("Please choose at least one of Employment Status available.");return false}else{return true}}function checkRadio(d){var a=document.getElementsByName(d);var c=0;for(var b=0;b<a.length;b++){if(a[b].checked){c++}}if(c<1){alert("Please choose one of the choice.");return false}else{return true}}function getElementsByFilter(tagname,querystring){arrobjs=document.getElementsByTagName(tagname);arrobjret=new Array();if(querystring!=null){arrquerystring=querystring.split(";");arrquery=new Array();for(var i=arrquerystring.length-1;i>=0;i--){arrtemp=new Array();arrtemp[0]=arrquerystring[i].split("=")[0];arrtemp[1]=arrquerystring[i].split("=")[1];arrquery.push(arrtemp)}looping:for(var i=arrobjs.length-1;i>=0;i--){for(var q=arrquery.length-1;q>=0;q--){attrquery=arrquery[q][0];attrvalue=arrquery[q][1];if(eval("arrobjs[i]."+attrquery)!=attrvalue){continue looping}}arrobjret.push(arrobjs[i])}}else{arrobjret=arrobjs}return arrobjret}
/*!
 * accounting.js v0.3.2
 * Copyright 2011, Joss Crowcroft
 *
 * Freely distributable under the MIT license.
 * Portions of accounting.js are inspired or borrowed from underscore.js
 *
 * Full details and documentation:
 * http://josscrowcroft.github.com/accounting.js/
 */
(function(o,g){var n={};n.version="0.3.2";n.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var p=Array.prototype.map,j=Array.isArray,f=Object.prototype.toString;function c(r){return !!(r===""||(r&&r.charCodeAt&&r.substr))}function k(r){return j?j(r):f.call(r)==="[object Array]"}function q(r){return r&&f.call(r)==="[object Object]"}function h(s,r){var t;s=s||{};r=r||{};for(t in r){if(r.hasOwnProperty(t)){if(s[t]==null){s[t]=r[t]}}}return s}function a(w,v,u){var t=[],s,r;if(!w){return t}if(p&&w.map===p){return w.map(v,u)}for(s=0,r=w.length;s<r;s++){t[s]=v.call(u,w[s],s,w)}return t}function l(s,r){s=Math.round(Math.abs(s));return isNaN(s)?r:s}function e(s){var r=n.settings.currency.format;if(typeof s==="function"){s=s()}if(c(s)&&s.match("%v")){return{pos:s,neg:s.replace("-","").replace("%v","-%v"),zero:s}}else{if(!s||!s.pos||!s.pos.match("%v")){return(!c(r))?r:n.settings.currency.format={pos:r,neg:r.replace("%v","-%v"),zero:r}}}return s}var i=n.unformat=n.parse=function(u,r){if(k(u)){return a(u,function(v){return i(v,r)})}u=u||0;if(typeof u==="number"){return u}r=r||n.settings.number.decimal;var t=new RegExp("[^0-9-"+r+"]",["g"]),s=parseFloat((""+u).replace(/\((.*)\)/,"-$1").replace(t,"").replace(r,"."));return !isNaN(s)?s:0};var b=n.toFixed=function(t,r){r=l(r,n.settings.number.precision);var s=Math.pow(10,r);return(Math.round(n.unformat(t)*s)/s).toFixed(r)};var d=n.formatNumber=function(t,w,z,v){if(k(t)){return a(t,function(A){return d(A,w,z,v)})}t=i(t);var r=h((q(w)?w:{precision:w,thousand:z,decimal:v}),n.settings.number),x=l(r.precision),u=t<0?"-":"",s=parseInt(b(Math.abs(t||0),x),10)+"",y=s.length>3?s.length%3:0;return u+(y?s.substr(0,y)+r.thousand:"")+s.substr(y).replace(/(\d{3})(?=\d)/g,"$1"+r.thousand)+(x?r.decimal+b(Math.abs(t),x).split(".")[1]:"")};var m=n.formatMoney=function(t,s,v,z,u,y){if(k(t)){return a(t,function(A){return m(A,s,v,z,u,y)})}t=i(t);var r=h((q(s)?s:{symbol:s,precision:v,thousand:z,decimal:u,format:y}),n.settings.currency),x=e(r.format),w=t>0?x.pos:t<0?x.neg:x.zero;return w.replace("%s",r.symbol).replace("%v",d(Math.abs(t),l(r.precision),r.thousand,r.decimal))};n.formatColumn=function(y,t,w,B,v,A){if(!y){return[]}var r=h((q(t)?t:{symbol:t,precision:w,thousand:B,decimal:v,format:A}),n.settings.currency),z=e(r.format),x=z.pos.indexOf("%s")<z.pos.indexOf("%v")?true:false,s=0,u=a(y,function(F,D){if(k(F)){return n.formatColumn(F,r)}else{F=i(F);var C=F>0?z.pos:F<0?z.neg:z.zero,E=C.replace("%s",r.symbol).replace("%v",d(Math.abs(F),l(r.precision),r.thousand,r.decimal));if(E.length>s){s=E.length}return E}});return a(u,function(D,C){if(c(D)&&D.length<s){return x?D.replace(r.symbol,r.symbol+(new Array(s-D.length+1).join(" "))):(new Array(s-D.length+1).join(" "))+D}return D})};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=n}exports.accounting=n}else{if(typeof define==="function"&&define.amd){define([],function(){return n})}else{n.noConflict=(function(r){return function(){o.accounting=r;n.noConflict=g;return n}})(o.accounting);o.accounting=n}}}(this));function autoEval(d,b,a){if(d){try{if(b==null||typeof(b)=="undefined"){b=","}if(a==null||typeof(a)=="undefined"){a="."}str=removeNumberFormat(d.value,b,a);if(str==""||isNaN(str)||str<0){d.value=0}else{if(str%1==0){d.value=moneyFormatERP(str,"",0,b,a)}else{d.value=moneyFormatERP(str,"",10,b,a)}}}catch(c){alert(c)}}}function removeNumberFormat(c,b,a){var d=String(c).replace(String.fromCharCode(160)," ");if(b!=""){d=d.split(b).join("")}if(a!="."){d=d.replace(a,".")}if(d==""||isNaN(d)){return 0}else{return d}}function applyDecimalFormat(b,a){var c=String(b);if(isNaN(c)){return 0}else{if(a!="."){c=c.replace(".",a)}return c}}function isIntOnly(b){if(b.which){var a=b.which}else{if(document.all&&event.keyCode){var a=event.keyCode}else{return true}}return((a==47)||(a==32)||(a==39)||(a==44)||(a==45)||(a==46)||(a==8)||(a>=48)&&(a<=57))}function setdecimal(obj,format){if(obj){try{if(obj.value==""){obj.value=0}obj.value=accounting.formatNumber(parseFloat(eval(obj.value.split(",").join(""))),format)}catch(e){alert(e)}}}function RoundNDecimal(d,c){var a,b=new String(Math.round(d*Number("1e"+c)));while(b.length<=c){b="0"+b}return b.substr(0,a=(b.length-c))+"."+b.substr(a,c)}function stripURL(h,k){if(h==null||k==null||k==""){return[h,0]}var g=h.split("&");var f=k.split(",");var a=[];var b=0;for(var e=0;e<g.length;e++){var d=g[e].split("=");for(var c=0;c<f.length;c++){if(d[0]!=f[c]){a.push(g[e])}else{b=1}}}return[a.join("&"),b]}function moneyFormatERP(g,f,a,d,c){if(f==null||f==""||typeof(f)=="undefined"){f=""}if(a==null||a==""||typeof(a)=="undefined"){g=parseFloat(g).toFixed(0)}else{g=roundX(g,-a);if(!isNaN(g)){word=g.toString();if(word.indexOf("e")>0){digit=word.substr(word.indexOf("e")+1,word.length-1);if(digit<0){g=g.toFixed(a)}}b=g.toString().split(".");if(b.length==1){b[1]="";for(cntDigit=0;cntDigit<a;cntDigit++){b[1]=b[1]+"0"}if(b[1]!=""){g=b[0]+"."+b[1]}else{g=b[0]}}else{if(b.length==2){currDigit=b[1].length;if(currDigit<a){for(cntDigit=0;cntDigit<a-currDigit;cntDigit++){b[1]=b[1]+"0"}}if(b[1]!=""){g=b[0]+"."+b[1]}else{g=b[0]}}}}}if(d==null||typeof(d)=="undefined"){d=","}if(c==null||typeof(c)=="undefined"){c="."}var e=new RegExp("(-?[0-9]+)([0-9]{3})");var h=g+"";var b=[];b=h.split(".");h=b[0];if(d!=""){while(e.test(h)){h=h.replace(e,"$1"+d+"$2")}}if(b.length>1){h=h+c+b[1]}return(f+h)}function roundX(a,b){if(typeof b==="undefined"||+b===0){return Math.round(a)}a=+a;b=+b;if(isNaN(a)||!(typeof b==="number"&&b%1===0)){return NaN}a=a.toString().split("e");a=Math.round(+(a[0]+"e"+(a[1]?(+a[1]-b):-b)));a=a.toString().split("e");return +(a[0]+"e"+(a[1]?(+a[1]+b):b))}function disableKeyPress(c,b){var a=b.split(",").indexOf((c.keyCode?c.keyCode:c.which).toString())==-1;if(a==false){c.preventDefault();return false}}function QtyFormatERP(f,a,d,c){if(a==null||a==""||typeof(a)=="undefined"){f=parseFloat(f).toFixed(0)}else{f=roundX(f,-a);if(!isNaN(f)){word=f.toString();if(word.indexOf("e")>0){digit=word.substr(word.indexOf("e")+1,word.length-1);if(digit<0){f=f.toFixed(a)}}b=f.toString().split(".");if(b.length==1){b[1]="";for(cntDigit=0;cntDigit<a;cntDigit++){b[1]=b[1]+"0"}if(b[1]!=""){f=b[0]+"."+b[1]}else{f=b[0]}}else{if(b.length==2){currDigit=b[1].length;if(currDigit<a){for(cntDigit=0;cntDigit<a-currDigit;cntDigit++){b[1]=b[1]+"0"}}if(b[1]!=""){f=b[0]+"."+b[1]}else{f=b[0]}}}}}if(d==null||typeof(d)=="undefined"){d=","}if(c==null||typeof(c)=="undefined"){c="."}var e=new RegExp("(-?[0-9]+)([0-9]{3})");var g=f+"";var b=[];b=g.split(".");g=b[0];if(d!=""){while(e.test(g)){g=g.replace(e,"$1"+d+"$2")}}if(b.length>1){g=g+c+b[1]}return(g)}function FormatNonRound(e,c,b){if(c==null||typeof(c)=="undefined"){c=","}if(b==null||typeof(b)=="undefined"){b="."}var d=new RegExp("(-?[0-9]+)([0-9]{3})");var f=e+"";var a=[];a=f.split(".");f=a[0];if(c!=""){while(d.test(f)){f=f.replace(d,"$1"+c+"$2")}}if(a.length>1){f=f+b+a[1]}return(f)}function arrayDiff(b,a){if(!isArray(b)||!isArray(a)){return""}if(b.length<a.length){var e=a;a=b;b=e}var d=[];var c=0;jQuery.grep(b,function(f){if(jQuery.inArray(f,a)==-1){d.push(f)}c++});return d}function arrayCommon(b,a){if(!isArray(b)||!isArray(a)){return""}if(b.length<a.length){var e=a;a=b;b=e}var d=[];var c=0;jQuery.grep(b,function(f){if(jQuery.inArray(f,a)!=-1){d.push(f)}c++});return d}function arrayUnique(a){if(!isArray(a)){return""}var b=[];$.each(a,function(c,d){if($.inArray(d,b)==-1){b.push(d)}});return b}function loadScripts(c,b){var a=document.getElementsByTagName("head")[0];if(b===undefined){b="text/javascript"}c.forEach(function(e){var d=document.createElement("script");d.type=b;d.src=e;a.appendChild(d)})}function loadStyles(b){var c="sfcss-";var a=document.getElementsByTagName("head")[0];b.forEach(function(e,d){var f=document.createElement("link");f.id=c+d;f.rel="stylesheet";f.type="text/css";f.href=e;f.media="all";a.appendChild(f)})}; /* res.ajax:IMPCF16-231 */ /* res.ajax:IMPCF16-231 */ if(typeof syserrmsg=="undefined"){var syserrmsg="We're sorry\n\nThe system is having trouble processing some requests\nPlease wait for a while or refresh your browser to reload the system\n\nShould the problem persist please contact system administrator"}var imgcpath="images/";var _nbscr=0;function runScriptsJSX(c){headEl=document.getElementsByTagName("head")[0];var a=document.getElementsByTagName("script");var f=[];var h=-1;var g=null;for(var d=_nbscr;d<_nbscr.length;d++){var b=b.item(d);var e=b.type.split(";")[0];if(scriptTypes.indexOf(e)!==-1){h=1;g=b}}_nbscr=a.length;if(h>=0){f.push(b.item(h))}if(f.length===0){return}}function loadScriptsJSX(g,c,h,f){var d,e;var b=document.getElementsByTagName("head")[0];var a=document.getElementsByTagName("script");if(c===undefined){c="text/babel"}if(h===undefined){h="utf-8"}if(window.XMLHttpRequest){d=new XMLHttpRequest()}else{d=new ActiveXObject("Microsoft.XMLHTTP")}g.forEach(function(l){var k="";var j=0;d.onreadystatechange=function(){if(d.readyState==4&&d.status==200){k=d.responseText;var m=document.createElement("script");m.type=c;m.text=k;m.charset=h;b.appendChild(m);if(f===undefined){Array.prototype.slice.call(document.querySelectorAll('script[type="text/babel"]')).forEach(function(n){var o=document.createElement("script");o.charset=h;o.innerHTML=Babel.transform(n.innerText,{presets:["es2015","react"]}).code;n.parentNode.insertBefore(o,n)})}}};d.open("GET",l,true);d.setRequestHeader("Content-Type","application/javascript; utf-8");d.send()})}function sethtml(c,j,l){if(c==null){return j}if(l==null){l=true}var n=j;var g=j;var k;var m="";if(l){var f=j.replace(/<script[^>]*>[^<]*<\/script>/gi,"");try{c.innerHTML=j}catch(h){try{if(typeof(jQuery)!="undefined"){$("#"+c.id).html(j)}else{throw (h)}}catch(h){try{c.innerHTML=f}catch(h){if(typeof(jQuery)!="undefined"){$("#"+c.id).html(f)}}}}c.title="";c.onclick=null;c.style.cursor="default"}while(k=n.match(/(<script[^>]*>\s*(<!--)?)/i)){n=n.substr(n.indexOf(RegExp.$1)+RegExp.$1.length);if(!(endscript=n.match(/((-->)?\s*<\/script>)/i))){break}block=n.substr(0,n.indexOf(RegExp.$1));n=n.substring(block.length+RegExp.$1.length);var b=document.createElement("script");if(block.substr(0,14).toUpperCase()=="CF_RUNCONTENT("){m+=block.substr(15,block.length-18);block=""}if(block!=""){b.text=block;var a=getParentTag(c,"BODY");if(a!=null){a=a.parentNode}else{a=document}var d=a.getElementsByTagName("head");if(d){if(d.item){if(bwtype=="IE"){if(d.item(0)){d.item(0).appendChild(b)}}else{d.item(0).appendChild(b)}}}}}if(m!=""){c.insertAdjacentHTML("beforeEnd",m)}return f}function GetXmlHttpObject(){var a=null;try{a=new XMLHttpRequest()}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}}return a}var inprefix="";function urlencode(b,a){if(a){return b}else{return encodeURIComponent(b)}}function form2query(theform,prefix,istruct){if(prefix==null){prefix=inprefix}if(istruct==null){istruct=false}var arrParam=new Array();var arrValue=new Array();var selm=new Array();var lselm="";for(var i=0;i<theform.elements.length;i++){var velm=theform.elements[i];if(velm.type!=null&&velm.type!="fieldset"){var vname=(velm.name!=""?velm.name:velm.id).replace(prefix,"");if(velm.type=="checkbox"){var vinp=eval("theform."+velm.name);var arrlselm=lselm.split(",");if(!vinp){continue}else{if(arrlselm.indexOf(vname)>=0){continue}}}try{selm.push(vname+"="+velm.value)}catch(e){}var ohdn=$sf("hdn_"+vname);if(ohdn){if(velm.id!=ohdn.id){ohdn=null}}if(ohdn==null){switch(velm.type){case"hidden":case"text":case"password":case"textarea":case"select-one":if(velm.value!=null&&vname!=""){if(theform.enctype=="multipart/form-data"&&velm.type=="textarea"){arrParam[arrParam.length]=vname+"="+urlencode(velm.value,istruct)+"="+velm.type;arrValue[arrValue.length]=velm.value}else{arrParam[arrParam.length]=vname+"="+urlencode(velm.value,istruct);arrValue[arrValue.length]=velm.value}}break;case"checkbox":if(vinp.length){lselm+=","+vname;var vval="";var vtxt="";for(var j=0;j<vinp.length;j++){if(vinp[j].checked&&vinp[j].value!=""){vval+=","+vinp[j].value;vtxt+=","+vinp[j].title}}arrParam[arrParam.length]=vname+"="+urlencode(vval.substr(1),istruct);arrValue[arrValue.length]=vtxt.substr(1);break}else{if(vname!=""){if(velm.checked){if((velm.value!=null&&velm.value!="")||(velm.lang!=null&&velm.lang!="")){var mvalue=(velm.value!=null&&velm.value!=""?velm.value:velm.lang);arrParam[arrParam.length]=vname+"="+urlencode(mvalue,istruct);arrValue[arrValue.length]=velm.title}}else{var odefa=$sf("defa_"+vinp.id);if(odefa){var mvalue=odefa.value;arrParam[arrParam.length]=vname+"="+mvalue;arrValue[arrValue.length]=velm.title}}}}break;case"radio":if(velm.checked&&((velm.value!=null&&velm.value!="")||(velm.lang!=null&&velm.lang!=""))&&vname!=""){var mvalue=(velm.value!=null&&velm.value!=""?velm.value:velm.lang);arrParam[arrParam.length]=vname+"="+urlencode(mvalue,istruct);arrValue[arrValue.length]=velm.title}break;case"select-multiple":var vval="";var vtxt="";for(var j=0;j<velm.options.length;j++){if(velm.options[j].selected&&velm.options[j].value!=""){vval+=","+velm.options[j].value;vtxt+=","+velm.options[j].text}}arrParam[arrParam.length]=vname+"="+urlencode(vval.substr(1),istruct);arrValue[arrValue.length]=vtxt.substr(1);break}}}}if(istruct){return[arrValue,arrParam]}else{return arrParam.join("&")}}function doesFileExist(a){var b=new XMLHttpRequest();b.open("HEAD",a,false);b.send();if(b.status=="404"){return false}else{return true}}function getAJAXContent(x,C,j,a,t,f){if(x==null){return""}var m=x;if(top.innerPop&&j==null){if(top.divBlockSpace){if(top.divBlockSpace.style.display=="none"){top.innerPop("")}}else{top.innerPop("")}}var l=null;try{$(".loading div table img").removeAttr("onclick")}catch(A){}try{$(t).find("#inp_companyparameterguide").remove();var y=$("<input>").attr({type:"hidden",name:"inp_companyparameterguide",id:"inp_companyparameterguide",value:companyparamtid}).appendTo(t)}catch(A){}if(typeof(t)=="string"){if(t=="error"){if(bwtype=="IE"){var g=-1;var w=navigator.userAgent;var u=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(u.exec(w)!=null){g=parseFloat(RegExp.$1)}if(g>-1&&g<9){var l=document.createElement("form")}}if(l==null){var l=document.createElement("form")}var B=document.getElementsByTagName("body")[0];B.appendChild(l);t=l;var v=document.createElement("input");v.name="sferr";v.type="hidden";v.value=f;t.appendChild(v);f=null}}if(t!=null&&t.enctype=="multipart/form-data"){if(m.length==0){return""}if(m.search(/&isajax=/gi)<0){m+="&isajax=yes"}if(m.search(/&lreqts=/gi)<0){m+="&lreqts="+jsnow()}var k=(function(){var e=document.createElement("div");return function(E){e.innerHTML=E;var F=e.firstChild;return e.removeChild(F)}})();var b=document.getElementById("frameAjax");if(b==null){b=k('<iframe src="javascript:false;" name="frameAjax" />');b.id="frameAjax";b.name="frameAjax";b.style.display="none";var B=document.getElementsByTagName("body")[0];B.appendChild(b)}var p=null;if(bwtype=="IE"){var g=-1;var w=navigator.userAgent;var u=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(u.exec(w)!=null){g=parseFloat(RegExp.$1)}if(g>-1&&g<9){var p=document.createElement('<form method="post" enctype="multipart/form-data" target="frameAjax" action="?"/>')}}if(p==null){var p=document.createElement("form");p.target="frameAjax";p.method="post";p.enctype="multipart/form-data"}p.action=m+"&cbfunc=parent.innerClose(function(){maskButton(false)});";var B=document.getElementsByTagName("body")[0];B.appendChild(p);var c=form2query(t);var s=c.split("&");for(i=0;i<s.length;i++){var o=s[i].split("=");var v=document.createElement("input");if(o.length>2){if(o[2]=="textarea"){v=document.createElement("textarea")}}v.name=o[0];v.value=decodeURIComponent(o[1]);p.appendChild(v)}var z=new Array();for(i=0;i<t.length;i++){if(t[i].type=="file"){var r=new Array();r[0]=t[i];r[1]=t[i].name;r[2]=t[i].parentNode;z[z.length]=r}}for(i=0;i<z.length;i++){p.appendChild(z[i][0]);z[i][0].name=z[i][1].substr(4)}p.submit();p.target="";for(i=0;i<z.length;i++){z[i][2].appendChild(z[i][0]);z[i][0].name=z[i][1]}B.removeChild(p);if(l!=null){B.removeChild(l)}}else{if(C==null||C=="undefined"){var n=null}else{if(typeof(C)=="string"){var n=$sf(C)}else{var n=C}}var h=n;if(m.length==0){if(n!=null){n.innerHTML=""}else{return""}}if(m.search(/&isajax=/gi)<0){m+="&isajax=yes"}if(m.search(/&lreqts=/gi)<0){m+="&lreqts="+jsnow()}var d=GetXmlHttpObject();if(d==null){alert("Your browser does not support AJAX");return""}try{m+="&cpts="+companyparamtid}catch(A){}if(t!=null){var D="POST";var q=form2query(t)}else{var D="GET";var q=""}d.open(D,m,true);if(D=="POST"){if(f==null){f="application/x-www-form-urlencoded"}d.setRequestHeader("Content-type",f+"; charset=UTF-8")}d.onreadystatechange=function(){if(d.readyState==4){objLoading=document.getElementById("divLoading");if(objLoading!=null){objLoading.style.display="none"}if(top.innerClose&&top.divPopup){if(top.divPopup.innerHTML.search("loading.gif")>=0){if(n){if(n.id!="divPopup"){top.innerClose()}}else{top.innerClose()}}}var E=d.responseText;if(top.divBlockSpace){var I='<img src="'+imgcpath+'icon/close-bg.png" title="Click to close block layer." alt="Click to close block layer." width="155" height="25" onclickx="unBlock();top.divBlockSpace.innerHTML=null;" style="position:absolute;left:'+top.divBlock.style.left+";top:"+top.divBlock.style.top+';">'}else{var I=""}if((E.search("rror Occurred While Processing Request</title>")>=0)||(E.search("<title>500 - Internal server erro")>=0)){var e=E;var H=Math.floor(Math.random()*1000000);E=E.replace(/<[^>]*>/gi,"");E=E.replace(/[\s]+/g,"");var G=E.indexOf("<body");if(G){E=E.substring(G,E.length-G)}if(bwtype!="Opera"&&m.search("sys.sec.logerr")<0){setCookie("CKSFERR",H+E.substr(0,1500),null,"/");getAJAXContent("?sfid=sys.sec.logerr&inum="+H+"&surl="+m+"&serr="+encodeURI(E),n,true,null,"error",e);if(typeof(sfalert)=="function"){sfalert(syserrmsg)}else{alert(syserrmsg)}if(top.divBlockSpace){top.divBlockSpace.style.textAlign="center";top.divBlockSpace.style.verticalAlign="middle";top.divBlockSpace.innerHTML=I}E=""}}else{if(E.search('class="Error"')>=0){var e=E;var H=Math.floor(Math.random()*1000000);E=E.replace(/<[^>]*>/gi,"_");E=E.replace(/[\s]+/g,"=");var G=E.indexOf("<body");if(G){E=E.substring(G,E.length-G)}if(bwtype!="Opera"&&m.search("sys.sec.logerr")<0){setCookie("CKSFERR",H+E.substr(0,1500),null,"/");getAJAXContent("?sfid=sys.sec.logerr&inum="+H+"&surl="+m+"&serr="+encodeURI(E),n,true,null,"error",e);E="";sfalert(syserrmsg);if(top.divBlockSpace){top.divBlockSpace.style.textAlign="center";top.divBlockSpace.style.verticalAlign="middle";top.divBlockSpace.innerHTML=I}}}}if(n!=null){var F=sethtml(n,E);if(j==null){document.body.style.cursor="default"}if(n.innerHTML!=""&&j!=false&&n.id!="spAjax"){if(F!=""){n.style.display=""}else{n.style.display="none"}}else{if(j!=false){n.style.display="none"}}if(a!=null){a(F,t)}}else{if(a!=null){a(E,t)}else{return E}}}else{objLoading=document.getElementById("divLoading");if(objLoading!=null){objLoading.style.left=((document.body.clientWidth-objLoading.clientWidth)/2)+"px";objLoading.style.top=((document.body.clientHeight-objLoading.clientHeight)/2)+"px";objLoading.style.display=""}}};d.send(q);if(j==null){document.body.style.cursor="wait"}}}function jsnow(){var a=new Date();return a.getTime()}function logResponse(e,h,d,l,j,n,m,a){if(j==null){j=false}var c=new Date();var b=c.getTime();var f=(b-l);var g="";var k="";if(!j&&a){n=100-f;m=a-n}g=n+f;k=b-m;getAJAXContent("?sfid=sys.sec.func.logresponse&laid="+e+"&lbid="+h+"&lcid="+d+"&rsp="+l+"&dntime="+b+"&dnrate="+f+"&udrate="+g+"&ldtime="+k,"spAjax",false)}; /* res.dragndrop:IMPCF16-231 */ /* res.dragndrop:IMPCF16-231 */ var dragElm=null;shiftElm=null;shLeft=null;shRight=null;vtemp="";_startX=null;_startY=null;_offsetX=0;_offsetY=0;_posX=0;function disableSelection(element,flag){element.onselectstart=function(){return flag};if(flag){element.unselectable="off";element.style.MozUserSelect="";element.style.cursor=""}else{element.unselectable="on";element.style.MozUserSelect="none";element.style.cursor="default"}}
function InitDragDrop(e,cbdn,cbup){document.onmousedown=function(e){OnMouseDown(e,cbdn)};document.onmouseup=function(e){OnMouseUp(e,cbup)}}
function OnMouseDown(e,cb){if(e==null)e=window.event;var target=e.target!=null?e.target:e.srcElement;if(target.lang!=null)if(target.lang=="dragable"){dragElm=getObject(target);disableSelection(document.body,false);startDrag(e)}else if(target.lang=="resizable"){shiftElm=getObject(target);disableSelection(document.body,false);startShift(e)}if(cb);if(!evtcal)hideCalendar()}
function OnMouseUp(e){dragElm=null;disableSelection(document.body,true);document.onmousemove=null;if(shiftElm!=null){if(e==null)e=window.event;var target=e.target!=null?e.target:e.srcElement;var vid="none";if(target.lang=="resizeTarget"&&shLeft!=null&&shRight!=null){var objresize=getObject(target);vid=objresize.id;var shiftX=0;if(objresize.id==shLeft.id)var shiftX=e.clientX-_startX;else if(objresize.id==shRight.id)var shiftX=e.clientX-_startX;if(shiftX!=0){var nwidth=parseInt(shLeft.offsetWidth)+
shiftX;if(nwidth<50){nwidth=50;shiftX=nwidth-parseInt(shLeft.offsetWidth)}}if(shiftX!=0){shLeft.style.width=parseInt(shLeft.offsetWidth)+shiftX+"px";shiftElm.style.left=parseInt(shiftElm.offsetLeft)+shiftX+"px";shRight.style.left=parseInt(shRight.offsetLeft)+shiftX+"px";var shnb=shRight.id.split("_");shnb=parseInt(shnb[shnb.length-1]);var oheader=shRight.parentNode;var vshift=false;var isc=null;var mspan=0;var temphbar=0;for(var i=0;i<oheader.childNodes.length;i++){var vheader=oheader.childNodes[i];
var chnb=vheader.id.split("_");chnb=chnb[chnb.length-1];if(chnb=="hbar"){chnb=pscroller-1;temphbar=1}else{chnb=parseInt(chnb);temphbar=0}if(vshift){if(chnb>=shnb&&vheader.lang!="scroller"&&vheader.lang!="splitter"&&!temphbar){vheader.style.left=parseInt(vheader.offsetLeft)+shiftX+"px";if(vheader.id.substr(0,14)=="data_"+areaid+"_"){var scobj=$sf("s_"+areaid+"_"+chnb);if(scobj!=null&&scobj.style.display!="none")scobj.style.left=parseInt(vheader.offsetLeft)+7+"px"}else;}else if(chnb==shnb-1&&!temphbar){vheader.style.width=
parseInt(vheader.offsetWidth)+shiftX+"px";if(vheader.id.substr(0,14)=="data_"+areaid+"_"){var scobj=$sf("s_"+areaid+"_"+chnb);var scobjspace=$sf("space_"+areaid+"_"+chnb);if(scobj!=null&&scobj.style.display!="none"){scobj.style.width=Math.max(70,parseInt(scobjspace.offsetLeft)-parseInt(vheader.offsetLeft)+3)+"px";scobj.style.left=parseInt(vheader.offsetLeft)+7+"px";scobj.childNodes[1].style.width=parseInt(scobj.offsetWidth)+"px";scobj.childNodes[1].childNodes[0].style.width=parseInt(scobj.offsetWidth)+
"px"}}}else if(oheader.id=="wnd_data"&&vheader.id.substr(0,14)=="data_"+areaid+"_"&&!temphbar){var vheadertemp=$sf("data_"+areaid+"_"+(chnb-1));var scobjspace=$sf("space_"+areaid+"_"+(chnb-1));vheadertemp.style.width=parseInt(vheadertemp.offsetWidth)+shiftX+"px";if(vheadertemp.id.substr(0,14)=="data_"+areaid+"_"){var scobj=$sf("s_"+areaid+"_"+(chnb-1));if(scobj!=null&&scobj.style.display!="none"){scobj.style.width=Math.max(70,parseInt(scobjspace.offsetLeft)-parseInt(vheadertemp.offsetLeft)+3)+"px";
scobj.style.left=parseInt(vheadertemp.offsetLeft)+7+"px";scobj.childNodes[1].style.width=parseInt(scobj.offsetWidth)+"px";scobj.childNodes[1].childNodes[0].style.width=parseInt(scobj.offsetWidth)+"px"}}}else;if(isc==null)if(vheader.lang=="scroller")isc=chnb;else if(vheader.lang!="splitter")mspan=Math.max(mspan,parseInt(vheader.offsetLeft)+parseInt(vheader.offsetWidth))}if(vheader.id==shRight.id)vshift=true}var hbar=$sf(areaid+"_hbar");if(hbar!=null){var dhbar=hbar.childNodes[0];if(dhbar!=null)dhbar.style.width=
parseInt(dhbar.offsetWidth)+shiftX+"px"}reposScroller()}}shiftElm=null;if(shLeft!=null){shLeft.style.cursor="";shLeft.childNodes[0].style.cursor="";shLeft.lang="";shLeft=null}if(shRight!=null){shRight.style.cursor="";if(shRight.childNodes.length)shRight.childNodes[0].style.cursor="";shRight.lang=vtemp;shRight=null}if(divsplitter!=null)divsplitter.style.display="none"}}var areaid="ardata_";
function startDrag(e){if(dragElm==null)return;document.onmousemove=OnMouseMove;_offsetX=document.body.scrollLeft;_offsetY=document.body.scrollTop;_startX=e.clientX;_startY=e.clientY}
function startShift(e){if(shiftElm==null)return;document.onmousemove=OnResizeCol;_offsetX=document.body.scrollLeft;_offsetY=document.body.scrollTop;var hbar=$sf(areaid+"_hbar");var hoffset=0;if(hbar!=null)if(hbar.style.display=="")hoffset=hbar.scrollLeft;_startX=e.clientX;_startY=e.clientY;_posX=_startX-3+hoffset;var nb=shiftElm.id.split("_");nb=parseInt(nb[nb.length-1]);shLeft=$sf(areaid+"_"+nb);shRight=$sf(areaid+"_"+(nb+1));if(shLeft!=null&&shRight!=null){shLeft.lang="resizeTarget";shLeft.style.cursor=
"e-resize";shLeft.childNodes[0].lang="resizeTarget";shLeft.childNodes[0].style.cursor="e-resize";vtemp=shRight.lang;shRight.lang="resizeTarget";shRight.style.cursor="e-resize";if(shRight.childNodes.length){shRight.childNodes[0].lang="resizeTarget";shRight.childNodes[0].style.cursor="e-resize"}if(divsplitter!=null){var odata=$sf("data_"+areaid+"_"+(nb+1));if(odata!=null){divsplitter.style.display="";divsplitter.style.left=parseInt(shRight.offsetLeft)-2+"px";divsplitter.style.top=parseInt(shRight.offsetTop)+
parseInt(shRight.offsetHeight)+"px";divsplitter.style.height=parseInt(shRight.parentNode.offsetHeight)-parseInt(shRight.offsetHeight)+"px"}}}}function OnMouseMove(e){if(e==null)var e=window.event;if(dragElm!=null){dragElm.style.left=parseInt(dragElm.offsetLeft)+e.clientX-_startX+"px";dragElm.style.top=parseInt(dragElm.offsetTop)+e.clientY-_startY+"px";_startX=e.clientX;_startY=e.clientY}}
function OnResizeCol(e){if(shiftElm==null||divsplitter==null)return;if(e==null)e=window.event;var shiftX=e.clientX-_startX;divsplitter.style.left=_posX+shiftX-3+"px"}function getObject(obj,tag){if(tag==null)tag="DIV";var found=obj.tagName==tag;while(!found){obj=obj.parentNode;if(obj==null)break;else found=obj.tagName==tag}if(found)return obj;else return null}var eftype=1;var tmr=30;
function effectClose(id,dw,dh,cfunc){var obj=$sf(id);var vwnd=obj.childNodes[0];if(obj.offsetWidth<30)obj.style.display="none";if(obj.offsetHeight<30)obj.style.display="none";if(obj.style.display==""){if(eftype==1||eftype==3||eftype==5||eftype==7){obj.style.width=Math.max(0,parseInt(obj.offsetWidth)-dw)+"px";if(eftype!=5){if(eftype!=7)obj.style.left=parseInt(obj.offsetLeft)+dw/2+"px";vwnd.style.left=parseInt(vwnd.offsetLeft)-dw/2+"px"}}if(eftype==1||eftype==2||eftype==4||eftype==6){obj.style.height=
Math.max(0,parseInt(obj.offsetHeight)-dh)+"px";if(eftype!=4){if(eftype!=6)obj.style.top=parseInt(obj.offsetTop)+dh/2+"px";vwnd.style.top=parseInt(vwnd.offsetTop)-dh/2+"px"}}setTimeout("effectClose('"+id+"',"+dw+","+dh+","+cfunc+")",tmr)}else if(cfunc)cfunc()}var opencnt=0;
function effectOpen(id,dw,dh,cnt){opencnt++;var obj=$sf(id);if(obj==null)return;else var vwnd=obj.childNodes[0];if(opencnt>1E3){opencnt=0;return}if(obj.offsetWidth<vwnd.offsetWidth||obj.offsetHeight<vwnd.offsetHeight){if(obj.offsetWidth<vwnd.offsetWidth&&(eftype==1||eftype==3||eftype==5||eftype==7)){var nwidth=Math.max(0,parseInt(obj.offsetWidth)+dw);obj.style.width=Math.max(0,parseInt(obj.offsetWidth)+dw)+"px";if(eftype!=5){if(eftype!=7)obj.style.left=parseInt(obj.offsetLeft)-dw/2+"px";vwnd.style.left=
parseInt(vwnd.offsetLeft)+dw/2+"px"}}if(obj.offsetHeight<vwnd.offsetHeight&&(eftype==1||eftype==2||eftype==4||eftype==6)){obj.style.height=Math.max(0,parseInt(obj.offsetHeight)+dh)+"px";if(eftype!=4){if(eftype!=6)obj.style.top=parseInt(obj.offsetTop)-dh/2+"px";vwnd.style.top=parseInt(vwnd.offsetTop)+dh/2+"px"}}setTimeout("effectOpen('"+id+"',"+dw+","+dh+","+(cnt+1)+")",tmr)}else{var gapw=parseInt(vwnd.offsetLeft);var gaph=parseInt(vwnd.offsetTop);obj.style.left=Math.max(0,parseInt(obj.offsetLeft)+
gapw)+"px";obj.style.top=Math.max(0,parseInt(obj.offsetTop)+gaph)+"px";vwnd.style.left=0;vwnd.style.top=0;obj.style.width=parseInt(vwnd.offsetWidth)+"px";obj.style.height=parseInt(vwnd.offsetHeight)+"px";if(typeof isFinishedPop!=="undefined")isFinishedPop=true}}
function centralView(id){var ownd=$sf(id);ownd.style.left=parseInt(document.body.scrollLeft)+(parseInt(document.body.clientWidth)-parseInt(ownd.offsetWidth))/2+"px";ownd.style.top=parseInt(document.body.scrollTop)+(parseInt(document.body.clientHeight)-parseInt(ownd.offsetHeight))/2+"px"}function closeWindow(id,cfunc){var ownd=$sf(id);var vwnd=ownd.childNodes[0];var dw=Math.ceil(parseInt(vwnd.offsetWidth)/10);var dh=Math.ceil(parseInt(vwnd.offsetHeight)/10);effectClose(id,dw,dh,cfunc)}
function openWindow(id){var ownd=$sf(id);ownd.style.display="";var vwnd=ownd.childNodes[0];var dw=Math.ceil(parseInt(vwnd.offsetWidth)/10);var dh=Math.ceil(parseInt(vwnd.offsetHeight)/10);effectOpen(id,dw,dh,1)}var ae_cb=null;function ae$(a){return document.getElementById(a)}
function ae_prompt(cb,q,a,t){ae_cb=cb;if(t!=null)ae$("aep_t").innerHTML=t;ae$("aep_prompt").innerHTML=q;ae$("aep_text").value=a;ae$("aep_ovrl").style.display=ae$("aep_ww").style.display="";ae$("aep_text").focus();ae$("aep_text").select()}function ae_clk(m){ae$("aep_ovrl").style.display=ae$("aep_ww").style.display="none";if(ae_cb!=null)if(!m)ae_cb(null);else ae_cb(ae$("aep_text").value)}; /* res.display:IMPCF16-231 */ /* res.display:IMPCF16-231 */ if(typeof(ismodif)==="undefined"){var ismodif=false}if(typeof(pstitle)==="undefined"){var pstitle=""}if(typeof(jsMsgMLang)==="undefined"){var jsMsgMLang=[]}jsMsgMLang.JSCONFIRMMODIFIEDPAGE="Data has been modified, You may loose your changes if you proceed\n\nContinue action ?";jsMsgMLang.CLICKTOCLOSE="Click to close";if(typeof(NOTIFLANGTEXT)==="undefined"){var NOTIFLANGTEXT=[]}NOTIFLANGTEXT.JSnotification="Notification";NOTIFLANGTEXT.JSshowagaintomorrow="Show again tomorrow";NOTIFLANGTEXT.JSshowwhenlogin="Show when login";NOTIFLANGTEXT.JSdonotshowanymore="Do not show any more";if(typeof(hasfilter)==="undefined"){var hasfilter=false}if(typeof(hassearch)==="undefined"){var hassearch=false}function SFdestroyReactElement(c){if(c===undefined){var c=$sf("sfreact-elm-id")}if(top.obj!=null&&typeof top.obj=="object"){try{top.ReactDOM.unmountComponentAtNode(top.document.getElementById(c.parentNode.id))}catch(b){}}else{if(parent.obj!=null&&typeof parent.obj=="object"){console.log("parent:"+parent.obj.parentNode.id);try{parent.ReactDOM.unmountComponentAtNode(parent.document.getElementById(c.parentNode.id))}catch(b){}}else{if(window.frames[0]&&(window.frames[0].obj!=null&&typeof window.frames[0].obj=="object")){try{window.frames[0].ReactDOM.unmountComponentAtNode(window.frames[0].document.getElementById(c.parentNode.id))}catch(b){}}else{if(window.opener&&(window.opener.obj!=null&&typeof window.opener.obj=="object")){try{window.opener.ReactDOM.unmountComponentAtNode(window.opener.document.getElementById(c.parentNode.id))}catch(b){}}else{if(c!=null&&typeof c=="object"){try{ReactDOM.unmountComponentAtNode(document.getElementById(c.parentNode.id))}catch(b){try{top.ReactDOM.unmountComponentAtNode(top.document.getElementById(c.parentNode.id))}catch(a){console.log("errObjTop:"+a)}}}else{}}}}}}function changePrintFilter(b,l){var n=$("#"+l);var m=n[0].outerHTML;var a=(m.match(/popPrint\([^\)]*\)/gi)[0]);var d=a.match(/\([^\)]+\)/gi)[0];d=d.substring(0,d.length-2).substr(2);var e=d.split("&amp;");var f=b.split("&");for(var h=e.length-1;h>=0;h--){var k=e[h].split("=")[0];if(arrCol.indexOf(k)>=0){e.splice(h,1)}else{if(f.length){for(var g=f.length-1;g>=0;g--){var c=f[g].split("=")[0];if(c==k){e.splice(h,1);f.splice(g,1);break}}}}}d=e.join("&")+"&"+b;m=m.replace(/popPrint\([^\)]*\)/gi,"popPrint('"+d+"')");n.replaceWith(m)}function changePrintOrder(b,g){var k=$("#"+g);var h=k[0].outerHTML;var a=(h.match(/popPrint\([^\)]*\)/gi)[0]);var c=a.match(/\([^\)]+\)/gi)[0];c=c.substring(0,c.length-2).substr(2);var d=c.split("&amp;");for(var e=d.length-1;e>=0;e--){var f=d[e].split("=")[0];if(f==b.split("=")[0]){d.splice(e,1)}}c=d.join("&")+"&"+b;h=h.replace(/popPrint\([^\)]*\)/gi,"popPrint('"+c+"')");k.replaceWith(h)}function searchStringinArray(a,c){for(var b=0;b<a.length;b++){if(a[b].match(c)){return b}}return -1}function getElementByAttribute(b,a,f){var e;var d=new Array();function c(g){if(g==null||g==undefined){return}if(e(g)){d[d.length]=g}c(g.firstChild);c(g.nextSibling)}if(f==undefined){f=document.body}str="if(Element."+b+"=='"+a+"'){return true;}else{return false}";e=function(h){Element=h;if(h.nodeName=="#text"){return false}var g=new Function(str);if(g()){return true}else{return false}};c(f);return d}var arcounter=0;var area=null;var arrCol=null;var areaid="ardata_";var popsearch=null;var opensearch=null;var prevrow=null;var maxwidth=2000;var imgpath="images/";if(imgcpath==null){var imgcpath="images/"}var isubmit=false;var timer=null;var submitinterval=2;var popmlink=null;var divsplitter=null;var spwidth=10;var scrollerwidth=17;var vpage=1;var pgid=null;var pscroller=null;var divBlockSpace=null;var divBlock=null;var divPopup=null;var iscomplete=true;var arrScroller=new Array();var arrSearch=new Array();var arrFilter=new Array();var arrFootNote=new Array();var filopr=1;var mLink="";var lastLink="";var gridFields=null;var jsNoField="No.";var ftIs="is";var ftAre="are";var ftNote="Showing_of_record(s)".split("_");var vmoremsg="View More";var msgSoA="Sort Ascending";var msgSoD="Sort Descending";var fsearch=false;arrFootNote.counter="";arrFootNote.filter="";arrFootNote.selection="";var time_format="HH:MM";var calendar_format="gregorian";var date_output_mask="d mmm yyyy";var pageurl="";var reloadFunc=null;var isreload=false;var enrow=20;var nbrec=100;function initPage(){InitDragDrop();if(typeof(formFields)==="undefined"||formFields==null){getAJAXContent("?ofid=LookUp.tipHoliday&fgrid=1","spAjax")}}function horizScroll(g,f){var e=$sf(f);e.style.left=-parseInt(g.scrollLeft);for(var c=0;c<e.childNodes.length;c++){var b=e.childNodes[c];var a=b.id.split("_");a=a[a.length-1];if(a=="hbar"){a=pscroller-1;temphbar=1}else{a=parseInt(a);temphbar=0}if(!temphbar){if(b.id.substr(0,14)=="data_"+areaid+"_"){var d=$sf("s_"+areaid+"_"+a);if(d!=null&&d.style.display!="none"){d.style.left=(parseInt(b.offsetLeft)+parseInt(e.offsetLeft)+7)+"px"}}}}}function removeFields(c,a){if(typeof(a)!="undefined"){c.splice(a,1)}for(var b=0;b<c.length-1;b++){if(c[b]["MEDIA"]){if(c[b]["MEDIA"].search("Grid")==-1){removeFields(c,b)}}}return c}function displayData(arrData,strow,enrow,nbrec,lscol,lsheader,idblock,lswidth,lstype,lslink){if(arrData==null){return}popsearch=$sf("_popsearch");if(idblock!=null){area=$sf(idblock)}if(area==null){area=document.body}gridFields=removeFields(gridFields);iscomplete=(enrow==nbrec);arcounter++;areaid="ardata_"+arcounter;arrCol=lscol.toLowerCase().split(",");var arrHeader=lsheader.split(",");var arrWidth=lswidth.split(",");var arrType=lstype.toLowerCase().split(",");var arrTypeExt=lstype.split(",");var arrLink=lslink.split("|");var cntColw=0;var cnew=true;var dnew=true;var podiv=$sf(areaid);if(podiv==null){var podiv=document.createElement("DIV");area.appendChild(podiv);with(podiv){id="p"+areaid;className="area"}var odiv=document.createElement("DIV");with(odiv){id=areaid;className="darea"}podiv.appendChild(odiv);var colpos=0;var prevheader=null;for(var i=0;i<=arrHeader.length;i++){var cdiv=document.createElement("DIV");var colid=areaid+"_"+i;odiv.appendChild(cdiv);prevheader=cdiv;var vsort="";if(i){vsort+='<img id="sortup_'+colid+'" src="'+imgcpath+'temp/sortup.png" title="'+msgSoA+'" align="absmiddle" hspace="0" border="0" style="cursor:pointer;margin-left:10px;" onclick="sortData('+i+',0)">';vsort+='<img id="sortdn_'+colid+'" src="'+imgcpath+'temp/sortdn.png" title="'+msgSoD+'" align="absmiddle" hspace="0" border="0" style="cursor:pointer;" onclick="sortData('+i+',1)">';if(gridFields!=null&&i>0){if(typeof(gridFields[i-1]["SORTABLE"])!=="undefined"){if(gridFields[i-1]["SORTABLE"]===true){}else{if(gridFields[i-1]["SORTABLE"]===false){vsort="&nbsp;"}else{vsort="&nbsp;"}}}}}with(cdiv){id=colid;className="colheader";if(arrHeader[i-1]&&arrHeader[i-1].toLowerCase()=="req_flag"){arrHeader[i-1]='<img src="'+imgcpath+'temp/request.png" align="absmiddle" hspace="0" border="0">';vsort="";var vHTML='<span class="header" id="header_'+colid+'">'+(i==0?jsNoField:arrHeader[i-1])+'</span><span id="spinq_'+colid+'" onclick="viewSearch();"></span>'+vsort+""}else{var sSearch='onclick="showSearch(this.parentNode,'+i+');"';if(gridFields!=null&&i>0){if(typeof(gridFields[i-1]["SEARCHABLE"])!=="undefined"){var isearch=""+(gridFields[i-1]["SEARCHABLE"]);isearch=isearch.toLowerCase();if(isearch=="true"||isearch=="yes"||isearch=="1"){isearch=true}else{if(isearch=="false"||isearch=="no"||isearch=="0"){isearch=false}}if(isearch===true){}else{if(isearch===false){sSearch=""}else{sSearch=""}}}}var vHTML='<span class="header" id="header_'+colid+'" '+sSearch+">"+(i==0?jsNoField:arrHeader[i-1])+'</span><span id="spinq_'+colid+'" onclick="viewSearch();"></span>'+vsort+""}if(gridFields!=null&&i>0){if(gridFields[i-1]["LABEL"]||gridFields[i-1]["ICON"]){var vHTML='<span class="header" id="header_'+colid+'" >'+(i==0?jsNoField:arrHeader[i-1])+"</span>";if(typeof(gridFields[i-1]["SORTABLE"])!=="undefined"){if(gridFields[i-1]["SORTABLE"]===true){vHTML+='<img id="sortup_'+colid+'" src="'+imgcpath+'temp/sortup.png" title="'+msgSoA+'" align="absmiddle" hspace="0" border="0" style="cursor:pointer;margin-left:10px;" onclick="sortData('+i+',0)">';vHTML+='<img id="sortdn_'+colid+'" src="'+imgcpath+'temp/sortdn.png" title="'+msgSoD+'" align="absmiddle" hspace="0" border="0" style="cursor:pointer;" onclick="sortData('+i+',1)">'}}}}innerHTML=vHTML;with(style){left=colpos+"px";if(arrWidth.length>0){var nw=""+arrWidth[i-1];if(nw!=""&&!isNaN(nw)){width=(i==0?offsetWidth+(arrData.req_status?0:0):Math.max(parseInt(nw),parseInt(offsetWidth)))+(bwtype.toLowerCase()=="safari"||bwtype.toLowerCase()=="chrome"?15:0)+"px"}else{width=(offsetWidth+(i==0&&arrData.req_status?0:0)+(bwtype.toLowerCase()=="safari"||bwtype.toLowerCase()=="chrome"?15+(i>1?10:0):0))+"px"}}if(prevheader!=null){}if(arrHeader.length){zIndex=1}}}if(i&&popsearch!=null){var sdiv=document.createElement("DIV");area.appendChild(sdiv);with(sdiv){id="s_"+areaid+"_"+i;className="popsearch";innerHTML="<BR>"+(popsearch.innerHTML.replace(/\[IDTEXT\]/gi,"txtSearch_"+i).replace(/\[IDCOL\]/gi,i));with(style){display="none"}if(arrType.length>=i){if(arrType[i-1].substring(0,4)=="date"||arrType[i-1].substring(0,5)=="sdate"){onmousedown=function(){evtcal=true};onmouseup=function(){evtcal=false};var vinp=$sf("txtSearch_"+i);if(vinp!=null){vinp.onfocus=function(event){popCalendar(event,this.id)};vinp.onmouseover=function(event){popCalendar(event,this.id)}}}else{if(arrType[i-1].substring(0,6)=="lookup"){var vinp=$sf("txtSearch_"+i);if(vinp!=null){var bfunc=arrType[i-1].replace(/;/gi,",").split("~");var lufunc=null;var vclick="";try{lufunc=eval(bfunc[1])}catch(e){}if(lufunc!=null){vclick=bfunc[1]+"(event,this"+(bfunc.length>1?","+bfunc[2]:"")+");"}else{var sfunc=new Array();switch(bfunc[1]){case"employstatus":sfunc=("tipLookUp|?ofid=LookUp.tipEmpStatus|"+(bfunc.length>2?","+bfunc[2]:"")).split("|");break;case"gradecat":sfunc=("tipLookUp|?ofid=LookUp.tipJobGrade|"+(bfunc.length>2?","+bfunc[2]:"")).split("|");break;case"department":sfunc=("tipLookUp|?ofid=LookUp.tipDepartment|"+(bfunc.length>2?","+bfunc[2]:"")).split("|");break;default:sfunc=("tipLookUp|?ofid=LookUp.tip"+bfunc[1]+"|"+(bfunc.length>2?","+bfunc[2]:"")).split("|");break}if(sfunc.length){vclick=sfunc[0]+"(event,'"+sfunc[1]+"',this"+sfunc[2]+");"}}if(vclick.length){vinp.mclick=vclick;vinp.ondblclick=function(event){try{eval(this.mclick)}catch(e){}}}}}}}}}colpos+=parseInt(cdiv.offsetWidth);var cdiv=document.createElement("DIV");var colid="space_"+areaid+"_"+i;with(cdiv){id=colid;className="colspt";if(vsort!=""){lang="resizable"}else{style.cursor="default"}innerHTML="&nbsp;";with(style){left=colpos+"px";paddingLeft="0px";paddingRight="0px";width=spwidth;if(arrHeader.length){zIndex=1}}}odiv.appendChild(cdiv);colpos+=parseInt(cdiv.offsetWidth)}var totwidth=colpos;if(arrHeader.length){var cdiv=document.createElement("DIV");area.appendChild(cdiv);var colid=areaid+"_"+(i);pscroller=i;with(cdiv){id=colid;className="colheader";lang="scroller";with(style){colpos=Math.min(colpos,parseInt(odiv.offsetWidth)-scrollerwidth);var mtbl=document.body.childNodes[0];if(mtbl.tagName==null){mtbl=document.body.childNodes[1]}var mleft=(mtbl.tagName.toUpperCase()=="TABLE"?parseInt(mtbl.cellPadding):"0");var mtop=mleft;left=colpos+mleft+1-(bwtype.toLowerCase()=="chrome"?1:0);width=parseInt(odiv.offsetWidth)-colpos-(bwtype=="IE"?1:3);borderRight="0px";zIndex=arrHeader.length-i+1;top=(bwtype=="IE"?30+mtop:odiv.offsetTop)+(bwtype.toLowerCase()=="chrome"?15:1)}}popmlink=document.createElement("DIV");with(popmlink){id="popmorelink";className="divmlink";innerHTML='<div id="divmlink" class="morelink" style="position:absolute; display:none;"><table height="100%" width"100%" border="0" align="center"><tr><td class="mlink" onclick="viewMore();">'+vmoremsg+"</td></tr></table></div>";with(style){display="none";zIndex="10"}}area.appendChild(popmlink);divsplitter=document.createElement("DIV");with(divsplitter){id="divsplitter";className="splitter";lang="splitter";innerHTML='<img src="'+imgcpath+'layout/spacer.gif" width="2" border="0">';with(style){display="none"}}odiv.appendChild(divsplitter)}}else{cnew=false;var odiv=podiv.childNodes[0]}var vhead=$sf(areaid+"_0");var dataHeight=parseInt(area.offsetHeight)-parseInt(vhead.offsetHeight);if(cnew){var hdiv=document.createElement("DIV");with(hdiv){id=areaid+"_hbar";className="coldata";with(style){var mleft=0;var mtop=mleft;left=odiv.offsetLeft+(bwtype=="IE"?mleft:0);width=parseInt(cdiv.offsetLeft);height=17;top=parseInt(area.offsetTop)+parseInt(area.offsetHeight)-(bwtype.toLowerCase()=="chrome"?37:7)+mtop;border="0px inset yellow";zIndex="1";position="absolute";overflowX="scroll";overflowY="hidden"}onscroll=function(elm,id){horizScroll(this,areaid)}}var dhdiv=document.createElement("DIV");with(dhdiv){id=areaid+"_dhbar";with(style){height="10";width=totwidth-17;position="relative";border="0px inset red"}}hdiv.appendChild(dhdiv);area.appendChild(hdiv);if(dhdiv.offsetWidth<hdiv.offsetWidth){hdiv.style.visibility="hidden"}}var cdiv=null;if(arrData[arrCol[0]]){arrFootNote.counter=ftNote[0]+" "+arrData[arrCol[0]].length+" "+ftNote[1]+" "+(nbrec!=null?nbrec:arrData[arrCol[0]].length)+" "+ftNote[2]}var vstr="";for(var i=0;i<arrSearch.length;i++){if(arrSearch[i][4]==1&&arrSearch[i][1]!=""){if(vstr!=""){vstr+=(filopr?", ":" or ")}if(arrSearch[i][2]=="sdate"&&arrSearch[i][6].match(/[,]/gi)!=null){vstr+=arrSearch[i][5]+" "+ftAre+" "+arrSearch[i][6]}else{vstr+=arrSearch[i][5]+" "+ftIs+" "+arrSearch[i][6]}var spinq=$sf("spinq_"+areaid+"_"+(i+1));if(spinq!=null){spinq.innerHTML='<img src="'+imgcpath+'temp/inquiry.png" height="13" hspace="2" border="0" align="absbottom">';spinq.title=arrSearch[i][6]}}else{var spinq=$sf("spinq_"+areaid+"_"+(i+1));if(spinq!=null){spinq.innerHTML="";spinq.title=""}}sortImg(i+1," asc",false);sortImg(i+1," desc",false);if(arrSearch[i][3]!=""){sortImg(i+1,arrSearch[i][3],true)}}if(vstr!=""){arrFootNote.filter="Filter: "+vstr}var invalidColumn=",";for(var i=0;i<=arrCol.length;i++){var colid="data_"+areaid+"_"+i;var cdiv=$sf(colid);if(arrSearch.length<=i&&i<arrCol.length){arrSearch[i]=new Array();arrSearch[i][0]=arrCol[i];arrSearch[i][1]="";arrSearch[i][2]=arrType[i].split("~")[0];arrSearch[i][3]="";arrSearch[i][4]=0;arrSearch[i][5]=arrHeader[i];arrSearch[i][6]=""}if(cdiv==null){var cdiv=document.createElement("DIV");var vhead=$sf(areaid+"_"+i);with(cdiv){id=colid;className="coldata";with(style){if(i>0){left=parseInt(vhead.offsetLeft)}else{left=parseInt(vhead.offsetLeft)}width=parseInt(vhead.offsetWidth)+spwidth;top=parseInt(vhead.offsetHeight);height=dataHeight}}}else{dnew=false}cntColw=cntColw+parseInt(cdiv.style.width);var dolid="cdata_"+areaid+"_"+i;var ddiv=$sf(dolid);var bnew=true;if(ddiv==null){var ddiv=document.createElement("DIV")}else{bnew=false}with(ddiv){id=dolid;className="ddata";style.width="100%";var strDataCol="";if(i==0){for(j=strow-1;j<enrow;j++){strDataCol+='<tr><td class="'+(j%2==0?"oddrow":"evenrow")+'" id="td_'+dolid+"_"+j+'" onmouseover="hover('+j+',1)" onmouseout="hover('+j+',0)" align="center" nowrap>';strDataCol+=""+(j+1);strDataCol+="</td></tr>"}}else{var d;for(j=strow-1;j<enrow;j++){talign="left";var sdata="";var nonval=false;var pretext="";if(invalidColumn.search(","+arrCol[i-1]+",")>=0){sdata="   -   ";talign="center"}else{try{var vdata=arrData[arrCol[i-1]][j];if(isArray(vdata)){if(vdata.length>1){if(vdata[1].search("~")>=0){pretext=vdata[1].split("~");if(pretext.length==2){pretext[1]=pretext[1].replace(/\\/gi,"");pretext='<img src="'+imgcpath+"temp/"+pretext[0]+'" height="16" hspace="2" title="'+pretext[1]+'" align="absmiddle">'}else{pretext=pretext[0]}}else{pretext=vdata[1];pretext='<img src="'+imgcpath+"temp/"+pretext+'" height="16" hspace="2" align="absmiddle">'}}else{pretext=vdata[1]}vdata=vdata[0]}if(arrCol[i-1]&&arrCol[i-1].toLowerCase()=="req_flag"){if(vdata!=1){vdata='<img src="'+imgcpath+"temp/datasts_"+vdata+'.png" align="absmiddle" hspace="2" border="0">'}else{vdata=""}nonval=true}sdata=vdata}catch(e){sdata="   -   ";talign="center";if(gridFields!=null){if(gridFields[i-1]["LABEL"]){sdata=gridFields[i-1]["LABEL"];nonval=true}else{if(gridFields[i-1]["ICON"]){sdata='<img src="'+imgcpath+"temp/"+gridFields[i-1]["ICON"]+'" class="button">';dstyle='style="padding:0px;"';nonval=true}}}if(sdata=="   -   "){invalidColumn+=arrCol[i-1]+","}}}if(sdata!="   -   "){if(!nonval){sdata=eschar(""+vdata)}if(gridFields!=null){if(gridFields[i-1]["LOOKUP"]){var splitpipe=gridFields[i-1]["LOOKUP"].split("|");for(var ks=0;ks<splitpipe.length;ks++){var splitequal=splitpipe[ks].split("=");if(splitequal[1]==sdata){sdata=""+ks}}ddata=getLookUp(gridFields[i-1]["LOOKUP"],sdata,"|");ddata=ddata.replace(/\\/gi,"");if(gridFields[i-1]["LOOKUPICON"]){sicon=getLookUp(gridFields[i-1]["LOOKUPICON"],sdata,"|");if(gridFields[i-1]["ALIGN"]){talign=gridFields[i-1]["ALIGN"]}else{talign="center"}if(sicon!=""){sdata='<img src="'+imgcpath+"temp/"+sicon+'" class="" title="'+ddata+'" hspace="2" alt="'+ddata+'">';dstyle='style="padding:0px;"';nonval=true}else{sdata=ddata;d}}else{sdata=ddata}}else{if(gridFields[i-1]["LISTSOURCE"]){try{var ardata=eval("arr"+(gridFields[i-1]["LISTSOURCE"].replace(/[.]/gi,"")).toUpperCase());sdata=getLookUp(ardata,sdata,"|")}catch(e){}}else{if(gridFields[i-1]["CONDITION"]){if(gridFields[i-1]["ICON"]){nonval=true;if(vdata!==""){sdata='<img src="'+imgcpath+"temp/"+gridFields[i-1]["ICON"]+'" class="button">';dstyle='style="padding:0px;"';talign="center"}}}}}}if(vdata=="****"){vdata=vdata}else{if(arrType.length){if(arrType[i-1].substring(0,8)=="datetime"||arrType[i-1].substring(0,9)=="sdatetime"){if(vdata!=null){var fdate=arrTypeExt[i-1].split("~");try{sdata=vdata.format(fdate.length==3?fdate[1]+""+fdate[2]:String(date_output_mask)+" "+String(time_format))}catch(err){sdata=vdata}}else{sdata=""}talign="center"}else{if(arrType[i-1].substring(0,4)=="date"||arrType[i-1].substring(0,5)=="sdate"||arrType[i-1].substring(0,4)=="time"){var fdate=arrTypeExt[i-1].split("~");var dformat=(fdate.length==2?fdate[1].replace(/;/gi,","):(arrType[i-1].substring(0,4)=="time"?time_format:date_output_mask));if(dformat==""&&fdate.length==2){dformat=(arrType[i-1].substring(0,4)=="time"?time_format:date_output_mask)}if(vdata!=null&&vdata!=""){if(!isNaN(vdata)){if(arrType[i-1].substring(0,4)!="time"){vdata=new Date(dateToStringJS(vdata.format("mm/dd/yyyy"),null,null,calendar_format))}sdata=vdata.format(dformat)}else{sdata=vdata}}else{sdata=""}talign="center"}else{if(arrType[i-1].substring(0,5)=="money"||arrType[i-1].substring(0,6)=="smoney"){if(vdata!=null&&vdata!==""){symbol="";var decimalcount=0;var moneyvar=arrType[i-1].split("~");var moneytemp=arrType[i-1].split(":");if(moneyvar.length>1){for(var z=0;z<gridFields.length;z++){if(gridFields[z].FIELD==moneyvar[1]){break}}decimalcount=getLookUp(arrMONEY,arrData[arrCol[z]][j],"|");sdata=moneyFormat(sdata,symbol,decimalcount,thousand_separator,decimal_separator);talign="right"}else{if(moneytemp.length>1){decimalcount=getLookUp(arrMONEY,moneytemp[1],"|");sdata=moneyFormat(sdata,symbol,decimalcount,thousand_separator,decimal_separator);talign="right"}else{if(moneytemp.length==1&&default_currency!=""){moneytemp.push(default_currency);decimalcount=getLookUp(arrMONEY,moneytemp[1],"|");sdata=moneyFormat(sdata,symbol,decimalcount,thousand_separator,decimal_separator);talign="right"}else{arrType[i-1]="numeric"}}}}else{sdata=(sdata.length>0?sdata:"");talign="right"}}else{if(arrType[i-1].substring(0,7)=="numeric"||arrType[i-1].substring(0,8)=="snumeric"){if(vdata!=null){symbol="";var numbervar=arrType[i-1].split("~");if(numbervar.length>1){var numbertemp=numbervar[1].search(/\./i);if(numbertemp!=-1){decimalcount=numbervar[1].length-numbertemp-1}}else{var numbertemp=numeric_format.search(/\./i);if(numbertemp!=-1){decimalcount=numeric_format.length-numbertemp-1}}sdata=moneyFormat(sdata,symbol,decimalcount,thousand_separator,decimal_separator);talign="right"}}else{if(arrType[i-1].substring(0,7)=="integer"||arrType[i-1].substring(0,8)=="sinteger"){if(vdata!=null){symbol="";var decimalcount=0;sdata=moneyFormat(sdata,symbol,decimalcount,thousand_separator,decimal_separator);talign="right"}}else{if(arrType[i-1]=="email"||arrType[i-1]=="semail"){if(vdata!=null){sdata='<a href="mailto:'+sdata+'">'+sdata+"</a>"}}}}}}}}else{if(typeObj(vdata)=="Date"){if(vdata!=null){sdata=new Date(dateToStringJS(vdata.format("mm/dd/yyyy"),null,null,calendar_format))}else{sdata=""}talign="center"}else{if(!isNaN(vdata)){sdata=moneyFormat(sdata);talign="right"}}}}if(vdata=="****"){vdata=vdata}else{if(arrLink.length>=i){if(arrLink[i-1]!=""){var vlink=arrLink[i-1].split(":");if(vlink.length>=2){var linkdata=getDataInfo(vlink[1],arrData,j);var itheName="popWin";var itheWidth="500";var itheHeight="400";var itheProp=null;var arrlinkdata=linkdata.split("~");if(arrlinkdata.length>1){if(arrlinkdata[1]){itheName=arrlinkdata[1]}if(arrlinkdata[2]){itheWidth=arrlinkdata[2]}if(arrlinkdata[3]){itheHeight=arrlinkdata[3]}if(arrlinkdata[4]){itheProp="'"+arrlinkdata[4]+"'"}}linkdata=arrlinkdata[0];linkdata=linkdata.replace(/%26lt%3B/g,"<").replace(/%26gt%3B/g,">").replace(/%26amp%3B/g,"%26");linkdata=linkdata.replace(/%/g,"%25").replace(/%2526nbsp%253B/g," ");var linktitle=(vlink.length>=3?getDataInfo(vlink[2],arrData,j,false).replace("&colon;",":"):"");if(sdata==""&&!nonval){sdata="..."}if(linkdata=="nolink"||sdata.split("!!!")[1]=="@nolink@"){arrSdata=sdata.split("!!!");arrSdata.splice(-1,1);sdata=arrSdata.join("!!!")}else{if(vlink[0].toLowerCase()=="link"){if(linkdata.search("javascript")<0){linkdata="javascript:redir('"+linkdata+"');"}sdata='<a href="'+linkdata+'" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="pop"){sdata="<a href=\"javascript:popWindow('"+linkdata+"','"+itheName+"',"+itheWidth+","+itheHeight+","+itheProp+');" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="innerpop"){sdata="<a href=\"javascript:innerPop('"+linkdata+'\',reposBlock);" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="print"){sdata="<a href=\"javascript:popPrint('"+linkdata+'\');" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="js"){sdata='<a href="javascript:'+linkdata+'" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="ajax"){sdata="<a href=\"javascript:getAJAXContent('"+linkdata+'\',\'spAjax\');" class="alink" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="tipinfo"){strInfoTip=" onmousedown=\"cInfoTip('ach_"+dolid+"_"+j+"',"+j+",'"+gridFields[i-1]["INFOTIP"]+"');\" ";achid="ach_"+dolid+"_"+j;sdata='<a href="javascript:void(0);" '+strInfoTip+' class="alink" id="'+achid+'" title="'+linktitle+'">'+sdata+"</a>"}else{if(vlink[0].toLowerCase()=="mobileinfo"){strInfoTip=" onmousedown=\"cInfoTip('ach_"+dolid+"_"+j+"',"+j+",'"+gridFields[i-1]["SHOWMOBILE"]+"');\" ";achid="ach_"+dolid+"_"+j;sdata='<a href="javascript:void(0);" '+strInfoTip+' class="alink" id="'+achid+'" title="'+linktitle+'">'+sdata+"</a>"}}}}}}}}}}}}}if(typeof gridFields[i-1]["TIP"]==="undefined"){var tipp=""}else{var tipp=gridFields[i-1]["TIP"]}strDataCol+='<tr><td class="'+(j%2==0?"oddrow":"evenrow")+'" id="td_'+dolid+"_"+j+'" align="'+talign+'" '+dstyle+' onmouseover="hover('+j+',1)" onmouseout="hover('+j+',0)" title="'+tipp+'" nowrap="nowrap">'+pretext+sdata+"</td></tr>"}}}if(bnew||strow==1){if(strDataCol!=""){strDataCol='<table cellpadding="0" cellspacing="0" width="100%"><tbody id="tbody_'+dolid+'">'+strDataCol+"</tbody></table>"}innerHTML=strDataCol}else{if(strDataCol!=""){if(bwtype=="IE"){strDataCol='<table cellpadding="0" cellspacing="0" width="100%"><tbody id="tbody_'+dolid+'">'+ddiv.childNodes[0].childNodes[0].innerHTML+strDataCol+"</tbody></table>";innerHTML=strDataCol}else{ddiv.childNodes[0].childNodes[0].innerHTML=ddiv.childNodes[0].childNodes[0].innerHTML+strDataCol}}}}if(dnew){cdiv.appendChild(ddiv)}if(cnew){odiv.appendChild(cdiv)}}if(arrCol.length){var cheight=(ddiv!=null?ddiv.offsetHeight:dateHeight);var colid="data_"+areaid+"_"+(i);var cdiv=$sf(colid);var cnew=true;if(cdiv==null){var cdiv=document.createElement("DIV");area.appendChild(cdiv);var vhead=$sf(areaid+"_"+(i));with(cdiv){id=colid;className="colscroll";vscroller=new Array();vscroller.push(colid);vscroller.push("cdata_"+areaid);vscroller.push(i);arrScroller.push(vscroller);lang="scroller";with(style){var mtbl=document.body.childNodes[0];if(mtbl.tagName==null){mtbl=document.body.childNodes[1]}var mleft=(mtbl.tagName.toUpperCase()=="TABLE"?parseInt(mtbl.cellPadding):"0");var mtop=mleft;left=parseInt(odiv.offsetLeft)+parseInt(vhead.offsetLeft)+(bwtype=="IE"?-2:-5);width=parseInt(vhead.offsetWidth)+(bwtype=="IE"?2:0);top=parseInt(odiv.offsetTop)+parseInt(vhead.offsetHeight)+(bwtype=="IE"?31+mtop:1)+(bwtype.toLowerCase()=="chrome"?15:0);height=dataHeight-(bwtype.toLowerCase()=="chrome"?46:1)}onscroll=function(elm,id,nb){dataScroll(this,"cdata_"+areaid,i)}}}else{cnew=false}var dolid="cdata_"+areaid+"_"+(i);var ddiv=$sf(dolid);var dnew=true;if(ddiv==null){var ddiv=document.createElement("DIV");cdiv.appendChild(ddiv);with(ddiv){id=dolid;className="coldatascroll";innerHTML="&nbsp;";var hbar=$sf(areaid+"_hbar");style.height=cheight+(hbar.style.visibility=="hidden"?0:17)}}else{dnew=false}}if(iscomplete&&popmlink!=null){if(popmlink.style.display==""){animateShow(popmlink.childNodes[0].id,1,1,0)}}resizeScroller();if(pscroller!=null){var vsc=$sf("data_"+areaid+"_"+pscroller);if(parseInt(vsc.scrollTop)>0){dataScroll(vsc,"cdata_"+areaid,pscroller)}}arrFilter=arrSearch.slice();writeFootNote();var dvcon1=$sf("content");var dvcon2=$sf("header");var dvcon3=$sf("nav");var dvcon4=$sf("wrapper");var viewportheight=document.documentElement.clientHeight;if(dvcon1!==null&&dvcon2!==null&&dvcon3!==null&&dvcon4!==null){var oheight=parseInt(dvcon2.offsetHeight)+parseInt(dvcon3.offsetHeight)}reposScroller(enrow,nbrec);window.enrow=enrow;window.nbrec=nbrec;cntColw=cntColw+(10*arrCol.length)-40;if(cntColw<=980){cntColw=980}cntColwi=cntColw-10;lastColw=arrCol.length+1;scevert=cntColw-24;cntRowh=29+22+(25*(enrow+2));cntRowhi=25*(enrow+2);if(cntRowh<=590){cntRowh=590}if(/Android|iPhone|iPod|iPad/.test(navigator.userAgent)){top.$("#wrapper").css("width",cntColw+"px");$("#content-title-bc").css("width",cntColwi+"px");$("#touch").children()[0].width=cntColwi+"px";top.$("#frmSFBody").css("width",cntColw+"px");$("#data_ardata_1_"+lastColw).css("width","24px");$("#data_ardata_1_"+lastColw).css("left",scevert+"px");top.$("#content").css("height",cntRowh+"px");for(var i=0;i<=arrCol.length;i++){$("#data_ardata_1_"+i).css("height",cntRowhi+"px")}reposScroller(enrow,nbrec)}}function getDataInfo(f,e,g,d){var h=f;var k=/\[[a-zA-Z0-9_]+\]/gi;var b=/[^-a-zA-Z0-9_/' ,.\(\)\[\];&]/gi;var a=null;var c=0;if(d==null){d=true}while(true){a=k.exec(h);c++;if(a==null||c>1000){break}var i=""+a;i=i.substr(1,i.length-2).toLowerCase();if(e[i]!=null){i=(""+e[i][g]).replace(a,"");arrMdata=i.split("!!!");if(arrMdata.length>1&&arrMdata[arrMdata.length-1]=="@nolink@"){h="nolink"}if(d){i=encodeURI(i)}else{i=i.replace(b,"")}h=h.replace(a,i)}else{h=h.replace(a,"")}k.lastIndex=0}return h}function dataScroll(d,b,a){var e=$sf(b+"_"+1);for(var c=0;c<a;c++){var e=$sf(b+"_"+c);if(e!=null){e.style.top=-(d.scrollTop)}}if(popmlink!=null){if(parseInt(d.scrollTop)+parseInt(d.offsetHeight)>=parseInt(d.scrollHeight)){if(!iscomplete){popmlink.style.display="";popmlink.style.top=parseInt(d.parentNode.offsetHeight)-parseInt(popmlink.offsetHeight)+34;popmlink.style.left=parseInt(d.parentNode.offsetWidth)-parseInt(popmlink.offsetWidth)-15;animateShow(popmlink.childNodes[0].id,0,1,0)}}else{if(popmlink.style.display==""&&timer==null){animateShow(popmlink.childNodes[0].id,1,1,0)}}}}function reposScroller(a,s){if(pscroller==null){return}var h=$sf(areaid+"_"+pscroller);var q=$sf("data_"+areaid+"_"+pscroller);var t=$sf("cdata_"+areaid+"_"+pscroller);var d=$sf("space_"+areaid+"_"+(pscroller-1));var u=$sf("data_"+areaid+"_"+(pscroller-1));var g=$sf("cdata_"+areaid+"_"+(pscroller-1));var o=$sf(areaid+"_hbar");var b=$sf(areaid);var n=$sf("content");var m=$sf("nav");var l=$sf("header");if(h==null||q==null||t==null||d==null||u==null||g==null){return}var e=parseInt(d.offsetLeft)+parseInt(d.offsetWidth);var p=parseInt(u.offsetHeight);var v=parseInt(g.offsetHeight);var k=document.body.childNodes[0];if(k.tagName==null){k=document.body.childNodes[1]}var i=(k.tagName.toUpperCase()=="TABLE"?parseInt(k.cellPadding):0);var r=i;if(e<parseInt(h.parentNode.offsetWidth)-scrollerwidth){h.style.left=(e+i+(bwtype=="IE"?1:1))+"px";h.style.width=(parseInt(h.parentNode.offsetWidth)-e)+"px";if(opener!=null){h.style.top="30px"}else{h.style.top=((bwtype=="IE"?30:area.offsetTop)+r+1)+"px"}q.style.left=(parseInt(h.offsetLeft)+(bwtype=="IE"?-10:bwtype=="Safari"?-10:-5))+"px";q.style.width=(parseInt(h.offsetWidth)+(bwtype=="FF"||bwtype=="Chrome"?-10:0)+10)+"px";q.style.top=(parseInt(h.offsetTop)+parseInt(h.offsetHeight)+(bwtype=="IE"?0:0))+"px";q.style.height=(area.offsetHeight-h.offsetHeight-2+(bwtype=="IE"?1:1))+"px"}else{if(parseInt(h.offsetLeft)!=parseInt(h.parentNode.offsetWidth)-scrollerwidth||parseInt(h.offsetWidth)!=scrollerwidth){h.style.left=(parseInt(h.parentNode.offsetWidth)-scrollerwidth+5)+"px";q.style.left=(parseInt(h.offsetLeft)+(bwtype=="IE"?-10:bwtype=="Safari"?-10:-5))+"px";q.style.width=(parseInt(h.offsetWidth)+(bwtype=="IE"?5:-10)+10)+"px"}if(bwtype.toLowerCase()=="chrome"){q.style.top=(parseInt(q.style.top)-100)+"px";q.style.height=(parseInt(q.style.height))+"px";h.style.top=(parseInt(h.style.top))+"px";o.style.width=(parseInt(q.offsetLeft))+"px"}if(bwtype.toLowerCase()=="ie"){q.style.top=(parseInt(q.style.top)-100)+"px";q.style.height=(parseInt(q.style.height))+"px";h.style.top=(parseInt(h.style.top))+"px";o.style.width=(parseInt(q.offsetLeft))+"px";h.style.width=scrollerwidth+"px"}}if(n&&e<parseInt(n.offsetWidth)){if(bwtype.toLowerCase()=="chrome"){h.style.left=e+"px";q.style.left=e+"px";q.style.top=(parseInt(q.style.top)+32)+"px";h.style.top=(parseInt(h.style.top)+29)+"px"}else{h.style.left=e+"px";q.style.left=e+"px";q.style.top=(parseInt(q.style.top)+29)+"px";h.style.top=(parseInt(h.style.top)+29)+"px"}}if(o!=null&&q!=null&&h!=null){o.style.width=parseInt(q.style.left)+"px";if(bwtype.toLowerCase()=="chrome"){if(m){h.style.top=(parseInt(m.offsetHeight)-4)+"px"}else{h.style.top="30px"}q.style.top=(parseInt(h.style.top)+parseInt(h.offsetHeight))+"px";q.style.height=(parseInt(area.offsetHeight)-30)+"px";q.style.width="17px";o.style.top=(parseInt(area.offsetHeight)+12)+"px";o.style.width=(parseInt(q.style.left))+"px"}else{if(bwtype.toLowerCase()=="ie"){if(m){h.style.top=(parseInt(m.offsetHeight)-4)+"px"}else{h.style.top="30px"}q.style.top=(parseInt(h.style.top)+parseInt(h.offsetHeight))+"px";q.style.width="17px";q.style.left=(parseInt(area.offsetWidth)-17)+"px";o.style.top=(parseInt(area.offsetHeight)+12)+"px";o.style.width=(parseInt(q.style.left))+"px"}else{o.style.top=(parseInt(q.offsetTop)+parseInt(q.offsetHeight)-17)+"px"}}o.scrollLeft=0;var w=o.childNodes[0];var c=q.childNodes[0];w.style.width=(parseInt(d.offsetWidth)+parseInt(d.offsetLeft)+1)+"px";if(w.offsetWidth>parseInt(q.offsetLeft)){if(o.style.visibility=="hidden"){c.style.height=(parseInt(c.offsetHeight)+17)+"px"}o.style.visibility="visible";if(parseInt(o.offsetLeft)+parseInt(o.offsetWidth)<parseInt(area.offsetWidth)-18){h.style.left=(parseInt(o.offsetLeft)+parseInt(o.offsetWidth))+"px";q.style.left=(parseInt(area.offsetWidth)-17)+"px";q.style.width="17px";o.style.width=(parseInt(q.style.left))+"px"}else{h.style.left=(parseInt(area.offsetWidth)-17)+"px";if(m){h.style.top=(parseInt(m.offsetHeight)-4)+"px"}else{h.style.top="30px"}q.style.top=(parseInt(h.style.top)+parseInt(h.offsetHeight))+"px";q.style.left=(parseInt(area.offsetWidth)-17)+"px";q.style.width="17px";o.style.width=(parseInt(q.style.left))+"px"}h.style.zIndex=0}else{if(o.style.visibility=="visible"){o.style.visibility="hidden";b.style.left="0px";c.style.height=(parseInt(c.offsetHeight)-17)+"px";h.style.zIndex=1}}}if(e<parseInt(area.offsetWidth)){o.style.visibility="hidden"}else{o.style.visibility="visible"}var f=document.getElementById("popmorelink");if((a*25<parseInt(q.style.height))&&(a<s)){f.style.display="block";f.style.top=parseInt(area.offsetHeight)-parseInt(f.offsetHeight)+34;f.style.left=parseInt(area.offsetWidth)-parseInt(f.offsetWidth)-17;document.getElementById("divmlink").style.display="block";animateShow(f.childNodes[0].id,0,1,0)}else{if(((parseInt(q.style.height)<parseInt(t.style.height))||a==s)&&f.style.display=="block"){animateShow(f.childNodes[0].id,1,1,0)}}}function hover(a,d){var e="";for(var b=0;b<=arrCol.length;b++){var c=$sf("td_cdata_"+areaid+"_"+b+"_"+a);if(c!=null){if(d){c.lang=c.className;c.className="selrow";e+=","+b}else{c.className=c.lang}}}prevrow=a}function hidemore(){if(popmlink!=null){if(popmlink.style.display==""){popmlink.style.display="none"}}}function resizeWindow(){var d=$sf(areaid+"_0");var a=parseInt(area.offsetHeight)-parseInt(d.offsetHeight);var c=null;var f=0;timer=null;if(popmlink!=null){if(popmlink.style.display==""){popmlink.style.display="none";timer=setTimeout("resizeWindow();",1000);return}}for(var b=0;b<=100;b++){var e=$sf("data_"+areaid+"_"+b);if(e!=null){e.style.height=a;if(parseInt(e.childNodes[0].offsetTop)+parseInt(e.childNodes[0].offsetHeight)<a){e.childNodes[0].style.top=Math.min(0,a-parseInt(e.childNodes[0].offsetHeight))}if(c!=null){f=parseInt(c.offsetLeft)+parseInt(c.offsetWidth)}c=e}else{break}}reposScroller(enrow,nbrec);if(divBlockSpace!=null){}}function adjustPopScroll(d,c,f,g,b){if(d==2&&c!=null){var e=Math.min(c,parseInt(f.offsetHeight)+parseInt(f.offsetTop));if(e>parseInt(f.parentNode.offsetHeight)||b){f.parentNode.style.height=e+(bwtype=="IE"?4:0);if(g!=null){var a=$sf(g);if(a!=null){if(a.style.display=="none"){a.style.width=parseInt(f.parentNode.offsetWidth);a.style.right=45}a.style.display="";a.style.top=parseInt(f.parentNode.offsetTop)+parseInt(f.parentNode.offsetHeight)}}}}}function animateShow(c,a,e,d,k,h,g,b){var f=$sf(c);if(k==null){k=10}if(h==null){h=100}if(d==null){d=1}if(e==null){e=0}timer=null;if(f==null){return}if(a){if(f.style.display=="none"||e){f.style.display="";f.style.top=(d?-parseInt(f.offsetHeight):0);f.style.width=parseInt(f.parentNode.offsetWidth);adjustPopScroll(d,g,f,b,true);timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{if(d){if(parseInt(f.offsetTop)<0){k=Math.min(k,-parseInt(f.offsetTop));f.childNodes[0].style.width=parseInt(f.parentNode.offsetWidth);f.style.top=parseInt(f.offsetTop)+k;adjustPopScroll(d,g,f,b);timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{f.style.top=0;var l=c.split("_");l=l[l.length-1];var i=$sf("txtSearch_"+l);if(i!=null){if(bwtype=="IE"){i.style.width="10px";f.style.width=parseInt(f.parentNode.offsetWidth);i.style.width=parseInt(i.parentNode.offsetWidth)}else{i.style.width="100%"}i.focus();i.select()}}}else{if(parseInt(f.offsetTop)+k<parseInt(f.offsetHeight)){f.style.top=parseInt(f.offsetTop)+k;timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{f.style.top=parseInt(f.offsetHeight);f.style.display="none";f.parentNode.style.display="none"}}}}else{if(f.style.display=="none"||e){f.style.display="";f.style.top=(d?0:parseInt(f.parentNode.offsetHeight));f.style.width=parseInt(f.parentNode.offsetWidth);adjustPopScroll(d,g,f,b,true);timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{if(d){if(parseInt(f.offsetTop)+parseInt(f.offsetHeight)-k>0){f.style.top=parseInt(f.offsetTop)-k;adjustPopScroll(d,g,f,b,true);timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{f.style.top=-parseInt(f.offsetHeight);f.style.display="none";f.parentNode.style.display="none";if(b!=null){var m=$sf(b);if(m!=null){m.style.display="none"}}}}else{if(parseInt(f.offsetTop)-k>0){f.style.top=parseInt(f.offsetTop)-k;timer=setTimeout("animateShow('"+c+"',"+a+",null,"+d+","+k+","+h+","+g+",'"+b+"')",h)}else{f.style.top=0}}}}}function resizeScroller(){if(pscroller==null){return}var d=null;var b=$sf("cdata_"+areaid+"_"+(pscroller-1));var c=$sf(areaid+"_hbar");if(b!=null){d=parseInt(b.offsetHeight)}var a=$sf("cdata_"+areaid+"_"+pscroller);if(d!=null&&d!=parseInt(a.offsetHeight)){if(parseInt(b.offsetTop)+d<parseInt(b.parentNode.offsetHeight)){for(var e=0;e<pscroller;e++){var f=$sf("cdata_"+areaid+"_"+e);if(f!=null){f.style.top="0"}}}a.style.height=d+(c.style.visibility=="hidden"?0:17)}}function showSearch(b,h,f){var c=$sf("s_"+areaid+"_"+h);var k=$sf("space_"+areaid+"_"+h);var i=$sf(areaid);if(c!=null){var d=(f==null?(c.style.display==""?"none":""):(f?"":"none"));if(f==null&&opensearch!=null&&d==""){if(opensearch.id!=c.id){var e=opensearch.childNodes[1].id;var a=opensearch.id.split("_");a=a[a.length-1];var g=$sf("txtSearch_"+a);if(g.value==""){arrSearch[a-1][4]=1;animateShow(e,0,1)}}}var e=c.childNodes[1].id;if(d==""){if(c.style.display!=d){c.style.display=d;c.style.top=parseInt(b.offsetTop)+(bwtype=="FF"?60:(bwtype=="IE"?57:61));c.style.width=(Math.max(70,parseInt(k.offsetLeft)-parseInt(b.offsetLeft)+3))+"px";c.style.left=(parseInt(b.offsetLeft)+parseInt(i.offsetLeft)+7)+"px";c.style.height="100px";opensearch=c;animateShow(e,1,1)}arrSearch[h-1][4]=1}else{if(arrFilter[h-1][4]==1){fsearch=false}arrSearch[h-1][4]=0;animateShow(e,0,1)}}}function validateInput(b,a){switch(a){case"smoney":return validateRange(b);break;case"money":return isMoney(b);break;case"sdate":return validateDateRange(b);break;case"date":return isDate(b);break;default:return validateString(b)}}function parseForm(frm,vdoc,arrF){var vsearch="";if(vdoc==null){vdoc=document}if(arrF==null){arrF=vdoc.arrSearch}for(var i=0;i<arrF.length;i++){var velm=eval("frm.inp_"+arrF[i][0]);if(velm!=null){if(velm.length!=null){var stype=velm[0].type}else{var stype=velm.type}switch(stype){case"text":case"hidden":case"password":case"textarea":case"select-one":case"file":if(velm.value!=""){arrF[i][1]=velm.value;if(arrF[i][2]=="sdate"||arrF[i][2]=="date"){arrF[i][1]=dateToStringJS(arrF[i][1],null,date_output_mask,calendar_format)}arrF[i][4]=1;vsearch+="&"+arrF[i][0]+"="+arrF[i][1];var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=arrF[i][1]}}else{arrF[i][1]="";arrF[i][4]=0;var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=""}}break;case"checkbox":var vval="";if(velm.length==null){velm[0]=velm}for(var j=0;j<velm.length;j++){if(velm[j].checked&&velm[j].value!=""){vval+=","+velm[j].value}}if(vval!=""){vval=vval.substr(1);arrF[i][1]=vval;arrF[i][4]=1;vsearch+="&"+arrF[i][0]+"="+arrF[i][1];var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=arrF[i][1]}}else{arrF[i][1]="";arrF[i][4]=0;var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=""}}break;case"radio":if(velm.length==null){velm[0]=velm}arrF[i][1]="";for(var j=0;j<velm.length;j++){if(velm[j].checked&&(velm[j].value!=""||velm[j].lang!="")){arrF[i][1]=(velm[j].value!=""?velm[j].value:velm[j].lang);arrF[i][4]=1;vsearch+="&"+arrF[i][0]+"="+arrF[i][1];var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=arrF[i][1]}break}}if(arrF[i][1]==""){arrF[i][4]=0;var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=""}}break;case"select-multiple":var vval="";for(var j=0;j<velm.options.length;j++){if(velm.options[j].selected&&velm.options[j].value!=""){vval+=","+velm.options[j].value}}if(vval!=""){vval=vval.substr(1);arrF[i][1]=vval;arrF[i][4]=1;vsearch+="&"+arrF[i][0]+"="+arrF[i][1];var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=arrF[i][1]}}else{arrF[i][1]="";arrF[i][4]=0;var vsch=$sf("txtSearch_"+(i+1),vdoc);if(vsch!=null){vsch.value=""}}}}if(arrF[i][3]!=""&&frm.fsort!=null){frm.fsort.value=arrF[i][0]+arrF[i][3]}}return vsearch}function filterSubmit(k){hasfilter=false;var e=0;for(var d=0;d<arrSearch.length;d++){if(arrSearch[d][3]=="filter"){hasfilter=true;break}}if(!hasfilter){var d=arrSearch.length}var l=form2query(k,"input_",true);var b=null;var g=null;for(var c=0;c<l[0].length;c++){var a=l[1][c].split("=")[0];var f=$sf(a);if(!f){continue}if(a.substr(0,4)=="cal_"){b=l[0][c]}else{if(a.substr(0,4)=="inp_"){g=(b?b:l[0][c]);if(!hasfilter){arrSearch[d]=new Array();arrSearch[d][0]=a;arrSearch[d][2]="";arrSearch[d][3]="filter";var h=f.parentNode.parentNode.childNodes[0].childNodes[0].innerHTML;arrSearch[d][5]=h}arrSearch[d][1]=l[1][c].split("=")[1];arrSearch[d][6]=g;if(arrSearch[d][1]!=""){arrSearch[d][4]=1;selm=f;e=d}else{arrSearch[d][4]=0}b=null;d++}}}arrFilter=arrSearch.slice();if(selm){checkSubmit(null,selm,e+1,false)}}function checkSubmit(A,l,g,c){if(isubmit){window.status="Still waiting from submission";return}if(c==null){c=true}var a=null;var b=false;if(!c){a=l}else{if(l.type=="text"){var A=window.event?event:A;var m=A.charCode?A.charCode:A.keyCode;if(arrSearch.length>=g){arrSearch[g-1][1]=l.value;arrSearch[g-1][6]=arrSearch[g-1][1];if(m==13){a=l;if(a.value==""){for(var y=0;y<arrFilter.length;y++){if(arrFilter[y][1]!=""){b=true;break}}}}}}else{if(l.id!=null){var a=$sf(l.id.substring(4))}}}if(a!=null){if(arrSearch.length>=g){if(arrSearch[g-1][3]!="filter"){arrSearch[g-1][1]=a.value;arrSearch[g-1][6]=arrSearch[g-1][1]}if(a.value!=""||hassearch){var r=validateInput(a.value,arrSearch[g-1][2]);if(r||hassearch){isubmit=true;if(arrSearch[g-1][2]=="date"){var x=stringToDateJS(arrSearch[g-1][1],date_input_mask,"mm/dd/yyyy",calendar_format);if(!x){isubmit=false}var f=arrSearch[g-1][0]+"="+encodeURIComponent(x)}else{if(arrSearch[g-1][2]=="sdate"){var B="";if(arrSearch[g-1][1].match(/[,]/gi)!=null){var h=new Array();var C=new Array();var h=arrSearch[g-1][1].split(",");for(var y=0;y<h.length;y++){h[y]=h[y].replace(/[^-0-9., \/]/gi,"");C[y]=stringToDateJS(h[y],date_input_mask,"mm/dd/yyyy",calendar_format);if(!C[y]){isubmit=false}B+=C[y];if(y!=h.length-1){B+=","}}var f=arrSearch[g-1][0]+"="+encodeURIComponent(B)}else{var h=new Array();var C=new Array();var h=arrSearch[g-1][1].split("-");for(var y=0;y<h.length;y++){h[y]=h[y].replace(/[^-0-9., \/]/gi,"");C[y]=stringToDateJS(h[y],date_input_mask,"mm/dd/yyyy",calendar_format);if(!C[y]){isubmit=false}if(y>0){if(C[y-1]>C[y]){var o=stringToDateJS(h[y-1],date_input_mask,date_input_mask,calendar_format);var n=stringToDateJS(h[y],date_input_mask,date_input_mask,calendar_format);alert("startdate("+o+") can not greate then enddate("+n+")");isubmit=false}}B+=C[y];if(y!=h.length-1){B+="-"}}var f=arrSearch[g-1][0]+"="+encodeURIComponent(B)}}else{var f=arrSearch[g-1][0]+"="+encodeURIComponent(arrSearch[g-1][1])}}var q="";for(var y=0;y<arrSearch.length&&isubmit;y++){if(arrSearch[y][4]==0){arrSearch[y][1]="";arrSearch[y][6]=""}if(arrSearch[y][4]==1&&arrSearch[y][1]!=""&&y!=g-1){if(!validateInput(arrSearch[y][1],arrSearch[y][2])){var d=$sf("s_"+areaid+"_"+(y+1));if(d!=null){isubmit=false;alert("Please input valid criteria");if(d.style.display==""){var d=$sf("txtSearch_"+(y+1));if(d!=null){d.focus();d.select()}}else{showSearch($sf(areaid+"_"+(y+1)),y+1)}break}}else{if(arrSearch[y][2]=="date"){var x=stringToDateJS(arrSearch[y][1],date_input_mask,"mm/dd/yyyy",calendar_format);if(!x){isubmit=false;break}f+="&"+arrSearch[y][0]+"="+encodeURIComponent(x)}else{if(arrSearch[y][2]=="sdate"||arrSearch[y][2]=="date"){var B="";if(arrSearch[y][1].match(/[,]/gi)!=null){var h=new Array();var C=new Array();var h=arrSearch[y][1].split(",");for(var u=0;u<h.length;u++){h[u]=h[u].replace(/[^-0-9., \/]/gi,"");C[u]=stringToDateJS(h[u],date_input_mask,"mm/dd/yyyy",calendar_format);if(!C[u]){isubmit=false;break}B+=C[u];if(u!=h.length-1){B+=","}}f+="&"+arrSearch[y][0]+"="+encodeURIComponent(B)}else{var h=new Array();var C=new Array();var h=arrSearch[y][1].split("-");for(var u=0;u<h.length;u++){h[u]=h[u].replace(/[^-0-9., \/]/gi,"");C[u]=stringToDateJS(h[u],date_input_mask,"mm/dd/yyyy",calendar_format);if(!C[u]){isubmit=false;break}if(u>0){if(C[u-1]>C[u]){var o=stringToDateJS(h[u-1],date_input_mask,date_input_mask,calendar_format);var n=stringToDateJS(h[u],date_input_mask,date_input_mask,calendar_format);alert("startdate("+o+") can not greate then enddate("+n+")");isubmit=false;break}}B+=C[u];if(u!=h.length-1){B+="-"}}f+="&"+arrSearch[y][0]+"="+encodeURIComponent(B)}}else{f+="&"+arrSearch[y][0]+"="+encodeURIComponent(arrSearch[y][1])}}}}if(arrFilter[y][3]!=""&&arrFilter[y][3]!="filter"){q="&fsort="+arrCol[y]+arrFilter[y][3]}}if(isubmit){hassearch=(b?b:r);timer=setTimeout("resetSubmit()",submitinterval*1000);hideCalendar();sendURL(mLink+"&"+f+q+"&filopr="+filopr+"&arid="+arcounter);if(document.getElementById("divGF")!=null){if(document.getElementById("keywords")!=null){var z=document.getElementById("divGF");var t=document.getElementById("keywords");z.removeChild(t)}var s=document.createElement("input");s.type="hidden";s.id="keywords";s.name="keywords";s.value=f;document.getElementById("divGF").appendChild(s)}vsearch2=f.toString().split("&");vsearch3=[];for(var k=0;k<vsearch2.length;k++){var p=vsearch2[k];var w=p.split("=")[1];if(w.search(/[']/g)==-1){vsearch3.push(p)}else{vsearch3.push(p.replace(/[']/g,"%22"))}}vsearch3=vsearch3.join("&");changePrintFilter(vsearch3,"PRINT");changePrintFilter(vsearch3,"PDF");changePrintFilter(vsearch3,"EXCEL");changePrintFilter(vsearch3,"OPENOFFICE")}}else{alert("Please input valid criteria");if(bwtype!="IE"){isubmit=true;timer=setTimeout("resetSubmit()",submitinterval*100)}a.focus();a.select()}}}}}function resetSubmit(){isubmit=false;timer=null}function writeFootNote(){var a=$sf("spFooter");if(a==null){return}var b="";if(arrFootNote.counter!=""){b+=arrFootNote.counter}if(arrFootNote.filter!=""){b+=(b!=""?"&nbsp;&nbsp;|&nbsp;&nbsp;":"");b+=arrFootNote.filter}if(arrFootNote.selection!=""){b+=(b!=""?" | ":"");b+=arrFootNote.selection}a.innerHTML=b}function viewMore(){var g="page="+(vpage+1);var f="";for(var d=0;d<arrFilter.length;d++){if(arrFilter[d][1]!=""){var a=arrFilter[d][1];if(arrFilter[d][2]=="sdate"||arrFilter[d][2]=="date"){a="";if(arrFilter[d][1].match(/[,]/gi)!=null){var c=new Array();var e=new Array();var c=arrFilter[d][1].split(",");for(var b=0;b<c.length;b++){c[b]=c[b].replace(/[^-0-9., \/]/gi,"");e[b]=stringToDateJS(c[b],date_input_mask,"mm/dd/yyyy",calendar_format);a+=e[b];if(b!=c.length-1){a+=","}}}else{var c=new Array();var e=new Array();var c=arrFilter[d][1].split("-");for(var b=0;b<c.length;b++){c[b]=c[b].replace(/[^-0-9., \/]/gi,"");e[b]=stringToDateJS(c[b],date_input_mask,"mm/dd/yyyy",calendar_format);a+=e[b];if(b!=c.length-1){a+="-"}}}}g+="&"+arrFilter[d][0]+"="+encodeURIComponent(a);arrFilter[d][4]=1}if(arrFilter[d][3]!=""&&arrFilter[d][3]!="filter"){f="&fsort="+arrFilter[d][0]+arrFilter[d][3]}}arrSearch=arrFilter.slice();isubmit=true;timer=setTimeout("resetSubmit()",submitinterval*1000);hideCalendar();sendURL(mLink+"&"+g+f+"&filopr="+filopr+"&arid="+arcounter)}function sendURL(b){var a="";if(b!=null){if(b=="1"){if(lastLink!=""){a=lastLink+"&reload=1"}}else{lastLink=b;a=lastLink}}if(a==""){a=mLink}if(a==""){reloadPage()}else{getAJAXContent(a,"spAjax")}}function sortImg(e,d,c){var g="";if(d==" asc"){g="sortup_"+areaid+"_"+e;var f=(c?"up.":"up_.");var b=(c?"up_.":"up.")}else{if(d==" desc"){g="sortdn_"+areaid+"_"+e;var f=(c?"dn.":"dn_.");var b=(c?"dn_.":"dn.")}}if(g==""){return}var a=$sf(g);if(a!=null){a.src=a.src.replace(f,b)}}function setFSort(d,b){var e=d.split(" ");if(e.length==2){for(var a=0;a<arrSearch.length;a++){if(arrSearch[a][0]==e[0]){var c=arrSearch[a][3];arrSearch[a][3]=" "+e[1];if(b){sortImg(a+1,arrSearch[a][3],true);if(c!=""&&c!=arrSearch[a][3]){sortImg(a+1,c,false)}}}else{if(b){sortImg(a+1,arrSearch[a][3],false)}if(arrSearch[a][3]!="filter"){arrSearch[a][3]=""}}}}}function sortData(l,k){var e=arrFilter[l-1][3];arrFilter[l-1][3]=(k?" desc":" asc");if(e==arrFilter[l-1][3]){return}var d="fsort="+arrFilter[l-1][0]+arrFilter[l-1][3];var a="";for(var h=0;h<arrFilter.length;h++){if(arrFilter[h][1]!=""){if(arrFilter[h][2]=="sdate"||arrFilter[h][2]=="date"){var b="";if(arrFilter[h][1].match(/[,]/gi)!=null){var f=new Array();var c=new Array();var f=arrFilter[h][1].split(",");for(var g=0;g<f.length;g++){f[g]=f[g].replace(/[^-0-9., \/]/gi,"");c[g]=stringToDateJS(f[g],date_input_mask,"mm/dd/yyyy",calendar_format);b+=c[g];if(g!=f.length-1){b+=","}}a+="&"+arrFilter[h][0]+"="+encodeURIComponent(b)}else{var f=new Array();var c=new Array();var f=arrFilter[h][1].split("-");for(var g=0;g<f.length;g++){f[g]=f[g].replace(/[^-0-9., \/]/gi,"");c[g]=stringToDateJS(f[g],date_input_mask,"mm/dd/yyyy",calendar_format);b+=c[g];if(g!=f.length-1){b+="-"}}a+="&"+arrFilter[h][0]+"="+encodeURIComponent(b)}}else{a+="&"+arrFilter[h][0]+"="+arrFilter[h][1]}arrFilter[h][4]=1}if(h!=l-1){sortImg(h+1,arrFilter[h][3],false);if(arrFilter[h][3]!="filter"){arrFilter[h][3]=""}}else{sortImg(h+1,arrFilter[h][3],true);if(e!=""&&e!=arrFilter[h][3]){sortImg(h+1,e,false)}}}arrSearch=arrFilter.slice();if(d!=null){isubmit=true;timer=setTimeout("resetSubmit()",submitinterval*1000);hideCalendar();sendURL(mLink+a+"&"+d+"&filopr="+filopr+"&arid="+arcounter);arrvsearch=d.split("&");vorder=arrvsearch[0];changePrintOrder(vorder,"PRINT");changePrintOrder(vorder,"PDF");changePrintOrder(vorder,"EXCEL");changePrintOrder(vorder,"OPENOFFICE")}}function viewSearch(a){if(a==null){a=!fsearch}fsearch=a;for(var b=0;b<arrFilter.length;b++){var c=$sf("spinq_"+areaid+"_"+(b+1)).childNodes[0];if(c!=null){if(arrFilter[b][1]!=""&&arrFilter[b][4]==!a){showSearch($sf(areaid+"_"+(b+1)),(b+1),a)}else{if(arrFilter[b][1]!=""&&arrFilter[b][4]==a){}else{showSearch($sf(areaid+"_"+(b+1)),(b+1),false)}}}else{if(!a){showSearch($sf(areaid+"_"+(b+1)),(b+1),false)}}}}function addButton(w,b,r,m){if(typeof(w)=="string"){var y=$sf(w)}else{var y=w;w=(y.id?y.id:y.name)}var q=b.split("|");var l="";var g=false;for(var u=0;u<q.length;u++){var p=q[u].split(":");var z="";var s="";var c="";if(p.length>=2){if(p[1].toLowerCase()=="close"){c="popClose(); return false;";s='<img src="'+imgcpath+'temp/cross.png" style="margin-right:4px;" align="absmiddle" hspace="0" border="0">'}else{if(p[1].toLowerCase()=="back"){c="history.back();";s='<img src="'+imgcpath+'icons/cross.png" style="margin-right:4px;" align="absmiddle" hspace="0" border="0">'}else{if(p[1].toLowerCase()=="delete"){if(p.length>=3){var h=(m?"top.document.":"document.")+w;var n="null";c=p[2];if(c.substr(0,1)=="?"){n="'"+c+"'"}else{if(c.split(".").length>=2){n="'?ofid="+c+"'"}}var x=(p.length>=4?p[3]:"");c="confirmDelete("+h+","+n+",'"+x+"');"}}else{if(y!=null&&p[1].toLowerCase()=="submit"){if(y.onsubmit==null){if(m){c="top.document."+w+".submit();"}else{c="document."+w+".submit();"}}else{var c=y.onsubmit.toString();var k=c.indexOf("{");c=c.substr(k+1,c.length-k-2);if(m){c=c.replace(/this/gi,"top.document."+w)}else{c=c.replace(/this/gi,"document."+w)}}s='<img src="'+imgcpath+'icons/tick.png" style="margin-right:4px;" align="absmiddle" hspace="0" border="0">'}else{if(y!=null&&p[1].toLowerCase()=="draft"){var h=(m?"top.document.":"document.")+w;c="strLinkOld=sLink;sLink=sLink+'&action=draft';validateForm("+h+");sLink=strLinkOld;"}else{if(y!=null&&p[1].toLowerCase()=="edit draft"){c="return false;"}else{if(y!=null&&p[1].toLowerCase()=="send to approver"){var h=(m?"top.document.":"document.")+w;c="strLinkOld=sLink;sLink=sLink+'&action=sendtoapprover';validateForm("+h+");sLink=strLinkOld;"}else{if(y!=null&&p[1].toLowerCase()=="preview approver"){c="return false;";if(p.length>=3){var h=(m?"top.document.":"document.")+w;var e="null";c=p[2];if(c.substr(0,1)=="?"){e="'"+c+"'";c="strLinkOld=sLink;sLink="+e+";strtargetOld="+h+".target;"+h+".target='popWinViewAppr';validateForm("+h+",'',false);sLink=strLinkOld;"+h+".target=strtargetOld;"}}}else{if(y!=null&&p[1].toLowerCase()=="reject"){var h=(m?"top.document.":"document.")+w;c="procFormRequest("+h+",0,1);"}else{if(y!=null&&p[1].toLowerCase()=="accept"){var h=(m?"top.document.":"document.")+w;c="procFormRequest("+h+",1,1);"}else{if(y!=null&&p[1].toLowerCase()=="close request"){var h=(m?"top.document.":"document.")+w;c="procFormRequest("+h+",2,1);"}else{if(y!=null&&p[1].toLowerCase()=="revise"){var h=(m?"top.document.":"document.")+w;c="procFormRequest("+h+",3,1);"}else{if(y!=null&&p[1].toLowerCase()=="cancel request"){var h=(m?"top.document.":"document.")+w;c="procFormRequest("+h+",4,1);"}else{if(p[1].toLowerCase()=="action"&&p.length>=3){c=p[2];if(c.substr(0,1)=="?"){c="location='"+c+"'"}}else{if(p[1].toLowerCase()=="auditlog"){if(p.length>=4){var h=(m?"top.document.":"document.")+w;var n="null";var o=p[3].split(",");var v=[];var a=[];var f=[];for(var t=0;t<o.length;t++){f=o[t].split("=");v.push(f[0]);a.push(f.length>=2?f[1]:"")}c="popLog('"+p[2]+"','"+p[3]+"');"}}}}}}}}}}}}}}}}if(c!=""){s="";z='<a id="btn_a_'+u+'" href="#" class="button" onclick="this.blur(); '+c+'"><span>'+s+p[0]+"</span></a>";l+=z}}}if(l!=""){if(r==null){top.document.write(l)}else{l='<div id="load_'+r+'" class="loading" style="display:none;"><div style="position:absolute;background-color:white;opacity:0.7;width:100%;height:100%;"></div><div style="position:absolute;width:100%;height:100%;text-align:center;"><table height="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td><img src="'+imgcpath+'temp/loader.gif" border="0" onclick="maskButton(false);"></td></tr></table></div></div>'+l;var d=$sf(r);if(d!=null){d.innerHTML=l}if(g){$('<div class="buttons">Add Request Decision Notes : <input type="checkbox" onclick="javascript:this.checked?$(\'#inp_request_notes\').show():$(\'#inp_request_notes\').hide();" name="chk_request_notes" id="chk_request_notes"><br><textarea style="display:none;height: 80px; width: 330px;" name="inp_request_notes" id="inp_request_notes"></textarea></div>').insertBefore($(d));$(d).css("clear","both")}}}if(typeof(y)!="object"){}}function procFormRequest(o,m,h){var l="";var b=$("#inp_request_no").val();var d=$("#inp_request_notes").val();if(typeof(b)==="undefined"){b=$("#inp_requestno").val()}if(typeof(b)==="undefined"){b=$("#inp_reqno").val()}if(typeof(b)==="undefined"){b=""}if(b.length<1){alert("Invalid Request Number!");return false}if(typeof(h)==="undefined"){var h=0}if(m==0){l="Are You Sure You Want to Reject this Request?"}else{if(m==1){l="Are You Sure You Want to Approve this Request?"}else{if(m==2){l="Are You Sure You Want to Close this Request?"}else{if(m==3){l="Are You Sure You Want to Revise this Request?"}else{if(m==4){l="Are You Sure You Want to Cancel this Request?"}}}}}if(confirm(l)){var g=({hdnReqNo:b,hdnAction:m,txtNotes:d});if(m==3||m==0){if(d.length<1){alert("Note Cant Be Empty!");$("#chk_request_notes").attr("checked",true);$("#inp_request_notes").show().get(0).focus();return false}}if(h!=1){$.post("?ofid=RequestInbox.ProcessRequest",g,function(p){try{$("#spAjax").html(p)}catch(e){}})}else{try{var a=(top==self?(opener?self:(frmSFBody?frmSFBody:self)):self)}catch(k){var a=self}var n=a.$sf("spAjax");var c=document.createElement("input");c.name="hdnReqNo";c.type="hidden";c.value=b;o.appendChild(c);var f=document.createElement("input");f.name="hdnAction";f.type="hidden";f.value=m;o.appendChild(f);var i=document.createElement("input");i.name="txtNotes";i.type="hidden";i.value=d;o.appendChild(i);getAJAXContent("?ofid=RequestInbox.ProcessRequest&isformreq="+h,n,null,function(){maskButton(false);refreshPage(false);popClose();try{opener.refreshPage()}catch(p){}},o)}}}function popLog(c,f){var d=f.split("$");var a=[];var g=[];var b=[];for(var e=0;e<d.length;e++){b=d[e].split("=");a.push(b[0]);g.push(b.length>=2?b[1]:"")}popPrint("?xfid=sys.setting.log.audit.listing&table_name="+c+"&pkey="+a.join(",")+"&sval="+g.join(","))}function innerClose(a){SFdestroyReactElement();if(divBlock){divBlock.style.display="none";divBlockSpace.style.display="none";if(a){a}}}function maskButton(flag){if(flag==null){flag=true}var vloader=$sf("divButton");if(vloader&&vloader.childNodes&&vloader.childNodes.length&&vloader.childNodes[0].className&&vloader.childNodes[0].className=="loading"){if(vloader.childNodes[0]!=null){if(vloader.childNodes[0].style.display=="none"&&flag){with(vloader.childNodes[0].style){display="";width=parseInt(vloader.offsetWidth)+"px";height=parseInt(vloader.offsetHeight)+"px"}}else{if(!flag){vloader.childNodes[0].style.display="none"}}}}if(!flag){try{parent.$sf("load_divButton").style.display="none"}catch(err){}try{$sf("frmSFBody").contentDocument.getElementById("load_divButton").style.display="none"}catch(err){}try{$sf("frmSFBody").contentDocument.getElementById("framecontent_1").contentDocument.getElementById("load_divButton").style.display="none";$sf("frmSFBody").contentDocument.getElementById("framecontent_2").contentDocument.getElementById("load_divButton").style.display="none";$sf("frmSFBody").contentDocument.getElementById("framecontent_3").contentDocument.getElementById("load_divButton").style.display="none";$sf("frmSFBody").contentDocument.getElementById("framecontent_4").contentDocument.getElementById("load_divButton").style.display="none";$sf("frmSFBody").contentDocument.getElementById("framecontent_5").contentDocument.getElementById("load_divButton").style.display="none";$sf("frmSFBody").contentDocument.getElementById("framecontent_6").contentDocument.getElementById("load_divButton").style.display="none"}catch(err){}}}function innerPop(theURL,cfunc){if(theURL==null){theURL=""}isCompletedPop=false;setTimeout("isCompletedPop=true",1000);var vparam=window.location.href;if(pstitle!=""&&theURL!=""){if(theURL.search("&origin=")<0){theURL+="&origin="+encodeURIComponent(pstitle)}}if(vparam.search(/&intab=/gi)>=0){popWindow(theURL);return}if(divBlockSpace==null){if(top.divBlockSpace!=null){divBlockSpace=top.divBlockSpace}else{divBlockSpace=$sf("divBlockSpace");if(divBlockSpace==null){divBlockSpace=top.document.createElement("DIV");top.document.body.appendChild(divBlockSpace);top.divBlockSpace=divBlockSpace;with(divBlockSpace){id="divBlockSpace";className="divBlockSpace";innerHTML="";style.display="none"}}}}if(divBlock==null){if(top.divBlock!=null){divBlock=top.divBlock}else{divBlock=$sf("divBlock");if(divBlock==null){divBlock=top.document.createElement("DIV");top.document.body.appendChild(divBlock);top.divBlock=divBlock;with(divBlock){id="divBlock";className="divBlock";style.display="";innerHTML="";style.width="200px";style.height="200px"}}}}if(divPopup==null){if(top.divPopup!=null){divPopup=top.divPopup}else{divPopup=$sf("divPopup");if(divPopup==null){divPopup=top.document.createElement("DIV");divBlock.appendChild(divPopup);top.divPopup=divPopup;with(divPopup){id="divPopup";className="divPopup";style.display="";innerHTML=""}}}}if(divBlockSpace.style.display=="none"){divPopup.innerHTML="";divBlockSpace.style.display="";var vheight=(bwtype=="IE"?document.documentElement.offsetHeight:window.innerHeight);var vwidth=document.documentElement.offsetWidth;with(divBlock.style){display="";width="100px";height="100px";border="0px solid blue";left=((parseInt(vwidth)-parseInt(divBlock.offsetWidth))/2)+"px";top=(((parseInt(vheight)-parseInt(divBlock.offsetHeight))/2)+0)+"px";divPopup.style.left=0;divPopup.style.top=0;divPopup.innerHTML='<img src="'+imgcpath+'icon/loading.gif" border="0" title="'+jsMsgMLang.CLICKTOCLOSE+'" onclick="innerClose();">'}if(theURL==""){return}}divBlockSpace.style.display="";if(theURL.search("isajax")<0){theURL+=(theURL.search(/\?/)<0?"?":"&")+"isajax=yes"}if(bwtype=="IE"){theURL+=(theURL.search(/\?/)<0?"?":"&")+"rand="+Math.floor((Math.random()*1000))}try{hideCalendar()}catch(e){}if(cfunc==null){cfunc=reposBlock}getAJAXContent(theURL,divPopup,1,cfunc);if(cfunc==reposBlock){cfunc=null}top.reloadFunc=function(){getAJAXContent(theURL,divPopup,1,cfunc)}}function pageReload(){SFdestroyReactElement();isreload=true;if(reloadFunc){reloadFunc()}}function reposBlock(){if(isreload){return}if(divBlock==null||divPopup==null){return}var vheight=(bwtype=="IE"?document.documentElement.offsetHeight:window.innerHeight);var vwidth=document.documentElement.offsetWidth;with(divBlock.style){display="";width=0;height=0;left=((parseInt(vwidth)-parseInt(divBlock.offsetWidth))/2)+"px";top=(20+((parseInt(vheight)-parseInt(divBlock.offsetHeight))/2))+"px";divPopup.style.left=-(parseInt(divPopup.offsetWidth)/2)+"px";divPopup.style.top=-(parseInt(divPopup.offsetHeight)/2)+"px"}openWindow("divBlock");isreload=false}function loadPage(b){var a=b.split(":");if(a.length>1){}}function loadSearch(b,a){innerPop("?xfid="+b+"&fsearch=false&schid="+a)}function initSearch(){reposBlock();var frm=document.frmFilter;if(arrSearch.length){for(var i=0;i<arrSearch.length;i++){var spinq=$sf("spinq_"+areaid+"_"+(i+1)).childNodes[0];if(spinq!=null){if(frm!=null){var velm=eval("frm.inp_"+arrSearch[i][0])}else{var velm=$sf("inp_"+arrSearch[i][0]);if(velm!=null){frm=velm.form}}if(velm!=null){var vtype=(velm.length?velm[0].type:velm.type);switch(vtype){case"text":case"hidden":case"password":case"textarea":case"select-one":case"file":velm.value=arrSearch[i][1];break;case"radio":if(velm.length==null){var tvelm=velm;velm=new Array();velm[0]=tvelm}for(var j=0;j<velm.length;j++){if(velm[j].value.toUpperCase()==arrSearch[i][1].toUpperCase()||velm[j].lang.toUpperCase()==arrSearch[i][1].toUpperCase()){velm[j].checked=true;break}}break;case"checkbox":if(velm.length==null){velm[0]=velm}for(var j=0;j<velm.length;j++){if((","+arrSearch[i][1]+",").search(","+velm[j].value+",")>=0||(","+arrSearch[i][1]+",").search(","+velm[j].lang+",")>=0){velm[j].checked=true}}break;case"select-multiple":for(var j=0;j<velm.options.length;j++){if((","+arrSearch[i][1]+",").search(","+velm.options[j].value+",")>=0){velm.options[j].selected=true}}break}}}}}}function refreshPage(a){SFdestroyReactElement();maskButton(false);try{if(opener!=null){if(a==false){sendURL(1)}else{opener.sendURL(1)}}else{if(top.actframe!=null){top.actframe.sendURL(1)}else{sendURL(1)}}}catch(b){}try{unBlock()}catch(b){}reposScroller(enrow,nbrec)}function reloadPage(){SFdestroyReactElement();try{if(hasModified()){if(!confirm(jsMsgMLang.JSCONFIRMMODIFIEDPAGE)){return}else{isconfirm=true}ismodif=false}}catch(a){}if(reloadFunc){reloadFunc()}else{location.reload()}}function listMobile(){location.reload()}function popSearch(a){viewSearch(false);innerPop("?xfid="+a+"&fsearch=false&arcounter="+arcounter,initSearch)}function popClose(a){if(a==null){a=true}try{if(hasModified()){if(!confirm(jsMsgMLang.JSCONFIRMMODIFIEDPAGE)){return}else{isconfirm=true}ismodif=false;if(frames){for(var b=0;b<frames.length;b++){if(frames[b].ismodif!=null){if(frames[b].ismodif){frames[b].ismodif=false}}}}}}catch(c){}if(divBlock==null||divBlockSpace==null){if(opener!=null){window.close()}else{if(!a){history.back(1)}}reposScroller(enrow,nbrec);return}else{try{hideCalendar()}catch(c){}try{closeWindow("divBlock",function(d){unBlock();if(divBlock.style.display=="none"){if(opener!=null){try{if(opener.imgpath||ddsmoothmenu==null){window.close()}}catch(f){}}return}});if($sf("popbox")||$sf("popmenu")){if(typeof(popMenu)!="undefined"){popMenu(null,false)}else{parent.popMenu(null,false)}if(typeof(popBox)!="undefined"){popBox(false)}else{parent.popBox(false)}}}catch(c){}}SFdestroyReactElement()}function unBlock(){divBlockSpace.style.display="none"}var opencnt=0;function slideBox(objid,dir,istart,vsp,vtm){var obj=$sf(objid);opencnt++;if(vsp==null){vsp=30}if(vtm==null){vtm=80}if(obj==null){return}if(dir==null){dir="ns"}var och=obj.childNodes[0];if(obj.style.display=="none"){istart=true}var vloop=true;if(opencnt>100){opencnt=0;return}if(istart){obj.style.display="";with(och.style){if(dir=="ns"){left=0;top=-parseInt(och.offsetHeight)+"px"}else{if(dir=="sn"){left=0;top=0}}}}else{if(dir=="ns"&&parseInt(och.offsetTop)+vsp<0){och.style.top=(parseInt(och.offsetTop)+vsp)+"px"}else{if(dir=="sn"&&parseInt(och.offsetTop)-vsp>-parseInt(och.offsetHeight)){och.style.top=(parseInt(och.offsetTop)-vsp)+"px"}else{opencnt=0;vloop=false;if(dir=="ns"){och.style.top=0}else{if(dir=="sn"){och.style.top=-parseInt(och.offsetHeight)+"px";obj.style.display="none"}}}}}if(vloop){setTimeout("slideBox('"+objid+"','"+dir+"',null,"+vsp+","+vtm+")",vtm)}}function validateNumber(c,b){if(b==null){b=0}var a=new RegExp("^([0-9]*|\d*.\d{1}?\d*)$","gi");if(c.value==""){return b}else{return(c.value.match(a)!=null)}}function addJavascript(c,d){var b=document.getElementsByTagName(d)[0];var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",c);b.appendChild(a)}function loadScript(b,e,d){if(e==null){e="head"}var c=document.getElementsByTagName(e)[0];var a=document.createElement("script");a.type="text/javascript";a.src=b;a.onreadystatechange=d;a.onload=d;c.appendChild(a)}function startsftour(pgid,ptype){var functiontour="startsftour_"+ptype+"_"+pgid+"()";eval(functiontour)}function closenofitywn(){excolTourNotify()}function excolTourNotify(){var a=$(".notif-page").width();if(a>30){$(".notif-page").width("30");$(".notif-page > .info").hide();$(".notif-page > .cls").hide()}else{}}var lfunc=function(){};arrSFNotif=[];timerNotif=false;arrNotifTmplt=[];isGrupNotifContent=true;var firstloadnotif=true;var lastnotiftempate="";var lmdnotif=0;function addNotif(d,f,e,g,a,c){if(typeof(a)=="undefined"){var a={}}if(typeof(c)=="undefined"){var c=true}var b=arrSFNotif.some(function(h){return h.notifid===e});if(d.length&&!b){arrSFNotif.push({text:d,notiftype:f,notifid:e,notifgroup:g,objData:a})}if(!isNaN(timerNotif)&&c){showSFNotif()}updateCounter()}function followUpNotif(i,k,a){if(typeof(k)=="undefined"){k=false}else{if(k==true){i=$(i).parents(".divContent")}}a=(typeof(a)=="undefined"?false:a);var l="";var g="";var e="";var m=true;var h=(typeof($(i).data("notiftemplate"))!="undefined"?$(i).data("notiftemplate"):"");h=(h==""&&typeof($(i).data("group"))!="undefined"?$(i).data("group"):h);if(typeof($(i).data("isreq"))!="undefined"&&$(i).data("isreq")!=null&&$(i).data("isreq").toString()!=""){m=($(i).data("isreq").toString()=="1"?true:false)}else{if(typeof(arrNotifTmplt[h])!="undefined"&&typeof(arrNotifTmplt[h]["isreq"])!="undefined"&&arrNotifTmplt[h]["isreq"]!=null){m=(arrNotifTmplt[h]["isreq"].toString()=="1"?true:false)}}if(typeof($(i).data("link"))!="undefined"&&$(i).data("link")!=null&&$(i).data("link")!=""){l=$(i).data("link")}else{if(typeof(arrNotifTmplt[h])!="undefined"&&typeof(arrNotifTmplt[h]["link"])!="undefined"&&arrNotifTmplt[h]["link"]!=null){l=arrNotifTmplt[h]["link"]}else{if(m){l="?sfid=sys.setting.workflow.listrequest&generalibx=1&fButton=true"}}}if(typeof($(i).data("prmlink"))!="undefined"&&$(i).data("prmlink")!=null&&$(i).data("prmlink")!=""){e=$(i).data("prmlink")}else{if(typeof(arrNotifTmplt[h])!="undefined"&&typeof(arrNotifTmplt[h]["prmlink"])!="undefined"&&arrNotifTmplt[h]["prmlink"]!=null){e=arrNotifTmplt[h]["prmlink"]}else{if(m){e="rid,req_no,company_id"}}}var b=e.split(",");var o=[];if(k){var n=[];if($(i).children(".divIsi").children("a")!==undefined){$(i).children(".divIsi").children("a").each(function(){if($(this).data("notifid")!==undefined){o.push($(this).data("notifid"))}})}if(o.length==0){if($(i).children(".divIsi")!==undefined){$(i).children(".divIsi").each(function(){if($(this).data("notifid")!==undefined){o.push($(this).data("notifid"))}})}}if(a){var f=(typeof($(i).children(".divIsi").children(".notifitem"))!="undefined"?$(i).children(".divIsi").children(".notifitem"):f=$(i).children(".divIsi"))}else{var f=$(i).children(".divIsi")}for(var d=0;d<b.length;d++){var n=[];if(f!==undefined){f.each(function(){if($(this).data(b[d])!==undefined){n.push(trim($(this).data(b[d])))}})}if(n.length>0){g+="&"+b[d]+"="+encodeURI(n.join())}}$(i).remove()}else{if(e!=""){for(var d=0;d<b.length;d++){if(typeof($(i).data(b[d]))!="undefined"){g="&"+b[d]+"="+encodeURI($(i).data(b[d]))}else{if(typeof($(i).parents(".divIsi").data(b[d]))!="undefined"){g="&"+b[d]+"="+encodeURI($(i).parents(".divIsi").data(b[d]))}}}}if(typeof($(i).data("notifid"))!="undefined"){o.push(encodeURI($(i).data("notifid")))}else{if(typeof($(i).parents(".divIsi").data("notifid"))!="undefined"){o.push(encodeURI($(i).parents(".divIsi").data("notifid")))}}var c=$(i).parents(".divContent");if($(i).prev().is(".dlmtritemN")){$(i).prev(".dlmtritemN").remove()}else{if($(i).next().is(".dlmtritemN")){$(i).next(".dlmtritemN").remove()}else{$(i).parents(".divContent").remove()}}$(i).remove();if(c.find(".notifitem").length==1){c.children(".divIsi").html($(i).data("text"))}}showSFNotif();updateCounter();removeCookie();if(o.length>0){$.get("?ofid=Notification.updateStatus&idseq="+o.join())}if(l!=""){popWindow(l+g+"","popNotif",700,600,"location=no,scrollbars=yes,status=no,toolbar=no,resizable=yes,menubar=no")}}function skipNotif(c,b){var a=$(c).parents(".divContent");var d=[];if(a.children(".divIsi").children("a")!==undefined){a.children(".divIsi").children("a").each(function(){if($(this).data("notifid")!==undefined){d.push($(this).data("notifid"))}})}if(d.length==0){if(a.children(".divIsi")!==undefined){a.children(".divIsi").each(function(){if($(this).data("notifid")!==undefined){d.push($(this).data("notifid"))}})}}a.remove();if(d.length>0){if(b==0){$.get("?ofid=Notification.updateStatus&idseq="+d.join())}else{$.get("?ofid=Notification.updateNotifOpt&act="+b+"&idshow="+d.join())}}if($(this).children(".divIsi").children("a")!==undefined){$(this).children(".divIsi").children("a").each(function(){if($(this).data("notifid")!==undefined){arrnotifid.push($(this).data("notifid"))}})}showSFNotif();updateCounter();removeCookie()}function showSFNotif(R,P){if(typeof(R)=="undefined"){R=false}var r=5;var g=false;var D=false;var K=$(".divContent").size();var d=$(".divIsi").size();var q=$(".notifitem").size();if((arrSFNotif.length||(typeof(P)!="undefined"&&P!=null))&&!isNaN(timerNotif)&&((K<r&&d<r)||R)&&q<14){if(R){if(typeof(P)!="undefined"&&P!=null){var G=P[0];if(Object.keys(G.objData).length>0){r=6}}else{return false}}else{var G=arrSFNotif.splice(0,1)[0]}var i=G.text;var k=G.notiftype;var L=G.notifid;var A=G.notifgroup;var t="";var N="#";var F=$("<div title=''>").addClass("divIsi").attr("data-notifid",L.toString());currnotiftempate="";isreqtmp="";if(Object.keys(G.objData).length>0){currnotiftempate=(typeof(G.objData.notiftemplate)!="undefined"?G.objData.notiftemplate:G.objData.NOTIFTEMPLATE);isreqtmp=(typeof(G.objData.isreq)!="undefined"?G.objData.isreq.toString():(typeof(G.objData.ISREQ)!="undefined"?G.objData.ISREQ.toString():""));if(typeof(currnotiftempate)!="undefined"&&typeof(arrNotifTmplt[currnotiftempate])!="undefined"){if(typeof(arrNotifTmplt[currnotiftempate]["text"])!="undefined"&&arrNotifTmplt[currnotiftempate]["text"]!=""&&arrNotifTmplt[currnotiftempate]["text"]!=null){i=arrNotifTmplt[currnotiftempate]["text"]}else{if(!R){arrSFNotif.splice(0,0,G)}return false}if(typeof(arrNotifTmplt[currnotiftempate]["linklabel"])!="undefined"&&arrNotifTmplt[currnotiftempate]["linklabel"]!=""&&arrNotifTmplt[currnotiftempate]["linklabel"]!=null){t=arrNotifTmplt[currnotiftempate]["linklabel"]}else{if(typeof(isreqtmp)!="undefined"){t=(isreqtmp.toString()=="1"?"req_no":t)}else{}}}t=(typeof(G.objData[t])!="undefined"?(G.objData[t]).toString():(typeof(G.objData[t.toUpperCase()])!="undefined"?(G.objData[t.toUpperCase()]).toString():""));$.each(G.objData,function(U,T){var W=T.toString();var X=T.toString();if(U.toLowerCase()=="req_no"){var V=$(T.toString());if(V.is("a")){W=V.html()}else{X="<a  href='javascript:void(0)' onclick='followUpNotif(this)'>"+W+"</a>"}i=i.replace(new RegExp("##"+U+"##","ig"),X)}else{i=i.replace(new RegExp("##"+U+"##","ig"),X)}F.attr("data-"+U,W)});D=(t==""?false:true);g=D;A=((currnotiftempate!=""&&D==true)?currnotiftempate.toString():A)}if(!g&&(K>=r-1||d>=r-1)){if(!R){arrSFNotif.splice(0,0,G)}else{return false}if(arrSFNotif.length){if($(".divContent").size()<5&&$(".divIsi").size()<5){}}}else{}if(D==false){F.html(i)}if(!firstloadnotif){var h=$("<div>").addClass("evenrow").css("background-color");F.css("background-color",h)}F.hover(function(){this.style["background-color"]="unset"});if(A!=""&&$('.divContent[data-group ="'+A+'"]').size()&&lastnotiftempate==currnotiftempate&&((R==false&&g==false)||(R))){Q=$('.divContent[data-group="'+A+'"]').last();var p="";var a="";var m=Q.find(".divIsi");if(Q.find(".notifitem").length==0&&Q.data("isgrouptxt")==true){var E=$("<a  href='javascript:void(0)' onclick='followUpNotif(this)'>");E.addClass("notifitem").attr("data-notifid",L).attr("data-text",m.html()).attr("href","javascript:void(0)");if(Object.keys(m.data()).length>0){if(typeof(m.data("notiftemplate"))!="undefined"&&typeof(arrNotifTmplt[m.data("notiftemplate")])!="undefined"){var x=m.data("notiftemplate").toString();if(typeof(arrNotifTmplt[x]["text"])!="undefined"&&arrNotifTmplt[x]["text"]!=""&&arrNotifTmplt[x]["text"]!=null){F.html(arrNotifTmplt[x]["text"])}if(typeof(arrNotifTmplt[x]["linklabel"])!="undefined"&&arrNotifTmplt[x]["linklabel"]!=""&&arrNotifTmplt[x]["linklabel"]!=null){p=arrNotifTmplt[x]["linklabel"]}else{if(typeof(m.data("isreq"))!="undefined"){p=isreqtmp=="1"?"req_no":p}}}$.each(m.data(),function(U,T){if(typeof(T)=="string"||typeof(T)=="number"||typeof(T)=="boolean"){E.attr("data-"+U.toString(),T.toString())}})}p=(typeof(m.data(p))!="undefined"?m.data(p).toString():"");E.attr("data-notif","itmlinktmp");if(p!=""&&t!=""&&isGrupNotifContent==true){E.html(p);var M="you have notif group following";var S="#";var O="";if(typeof(arrNotifTmplt[A]["group"])!="undefined"){O=arrNotifTmplt[A]["group"]}if(O!=""){if(typeof(arrNotifTmplt[O])!="undefined"){if(typeof(arrNotifTmplt[O]["text"])!="undefined"&&arrNotifTmplt[O]["text"]!=""&&arrNotifTmplt[O]["text"]!=null){M=arrNotifTmplt[O]["text"]}if(typeof(arrNotifTmplt[O]["link"])!="undefined"&&arrNotifTmplt[O]["link"]!=""&&arrNotifTmplt[O]["link"]!=null){S=arrNotifTmplt[O]["link"]}else{if(typeof(m.data("isreq"))!="undefined"){S=m.data("isreq").toString()=="1"?"?sfid=sys.setting.workflow.listrequest&generalibx=1&fButton=true":S}}}}m.html(M+" ");E.appendTo(m)}else{Q.attr("data-isgrouptxt",true)}Q.children(".spTitle").children("#btnflwup").attr("onclick","").click(new Function("followUpNotif(this,true,true)"))}else{p="linkLblTmp"}if(p!=""&&t!=""&&Q.data("isgrouptxt")==true){var o=$("<a href='javascript:void(0)' onclick='followUpNotif(this)'>").addClass("notifitem").attr("data-notifid",L).attr("data-text",i);$.each(G.objData,function(U,T){o.attr("data-"+U.toString(),T.toString())});o.html(t);o.attr("data-notif","itmlink");var v=$("<font>").addClass("dlmtritemN").html(", ");m.append(v).append(o)}else{Q.attr("data-isgrouptxt",true);F.appendTo($('.divContent[data-group ="'+A+'"]'));if(!firstloadnotif){var h=$("<div>").addClass("evenrow").css("background-color");F.css("background-color",h)}F.hover(function(){this.style["background-color"]="unset"});Q.append(F)}}else{if(!R){var Q=$("<div>").addClass("divContent").addClass(k);Q.attr("data-group",A);Q.attr("data-isgrouptxt",D);var H=$("<div title=''>").text(NOTIFLANGTEXT.JSnotification).addClass("spTitle btn-page portal").css("cursor","pointer");var s=$("<div title='' width='20px'  height='20px'>").addClass("boxAct");var u=$("<div>").addClass("listAct");var C=$("<ul>");var B=$("<li style='width:150px' title='' onclick='skipNotif(this,2)'>"+NOTIFLANGTEXT.JSshowagaintomorrow+"</li>").data("notifid",L).appendTo(C);var z=$("<li style='width:150px' title='' onclick='skipNotif(this,4)'>"+NOTIFLANGTEXT.JSshowwhenlogin+"</li>").data("notifid",L).appendTo(C);var y=$("<li style='width:150px' title='' onclick='skipNotif(this,0)'>"+NOTIFLANGTEXT.JSdonotshowanymore+"</li>").data("notifid",L).appendTo(C);var e=$("<div id='btnflwup' title='"+NOTIFLANGTEXT.JSfollowup+"' onclick='followUpNotif(this,true);'>").addClass("boxFlwUp");C.appendTo(u);u.appendTo(s);F.html(i);s.appendTo(H);e.appendTo(H);u.appendTo(s);Q.append(H,F);Q.hide().appendTo("#divSFNotif");Q.show(600)}else{return false}}if(document.cookie.indexOf("COOKIENOTIF")!==-1&&getCookie("COOKIENOTIF")=="on"){$(".divContent").css("display","none")}if(arrSFNotif.length){timerNotif=setTimeout(function(){showSFNotif()},1000)}lastnotiftempate=currnotiftempate;if(!R&&arrSFNotif.length){var I=(K>d?K:d);var l=15-q;var b=l;var c=0;l=(arrSFNotif.length<l?arrSFNotif.length:l);for(var w=0;w<l;w++){if(typeof(arrSFNotif[w])!="undefined"){var n=(typeof(arrSFNotif[w].objData.notiftemplate)!="undefined"?G.objData.notiftemplate:arrSFNotif[w].objData.NOTIFTEMPLATE);if(n==lastnotiftempate){var f=arrSFNotif.splice(w,1);var J=showSFNotif(true,f);if(J){l-=1;w-=1;c+=1;if(c>=b||$(".divContent").size()>5||$(".divIsi").size()>5){break}}else{arrSFNotif.splice(w,0,f[0])}}else{}}else{break}}}else{if(!R&&arrSFNotif.length){if($(".divContent").size()<5&&$(".divIsi").size()<5){showSFNotif()}}}}else{return false}return true}setTimeout(function(){firstloadnotif=false},10000);function getclick3(){$listAct3.click();showSFNotif();updateCounter()}function closeNotif(){$(".boxAct.closeNotif").click(function(){$(this).parent().parent().remove();showSFNotif();updateCounter()})}function updateClosedNotif(a){if($(a).parents(".divIsi").siblings(".divIsi").size()){$.get("?ofid=Notification.updateStatus&idseq="+$(a).parents(".divIsi").data("notifid"));$(a).parents(".divIsi").remove()}else{$.get("?ofid=Notification.updateStatus&idseq="+$(a).parents(".divContent").data("notifid"));$(a).parents(".divContent").remove();removeCookie()}showSFNotif();updateCounter()}function removeCookie(){if($(".divContent").length==0){$(".nt-exp").remove()}}function minimizeNotif(){if($(".divContent").size()>0&&$(".notif-group").length<1){var c=$("<div>").addClass("nt-exp");var a=$("<div>").addClass("notif-group");var b=0;$(".divIsi").each(function(f,e){b+=($(e).children(".notifitem").length==0?1:$(e).children(".notifitem").length)});b+=arrSFNotif.length;var d=$("<div>").addClass("val").text(b);c.appendTo("#divSFNotif");a.appendTo(c);d.appendTo(a);c.click(function(){$(".divContent").toggle("fade");if(document.cookie.indexOf("COOKIENOTIF")==-1){setCookie("COOKIENOTIF","on")}else{if(getCookie("COOKIENOTIF")=="off"){setCookie("COOKIENOTIF","on")}else{setCookie("COOKIENOTIF","off")}}})}}function updateCounter(){var a=0;$(".divIsi").each(function(d,c){a+=($(c).children(".notifitem").length==0?1:$(c).children(".notifitem").length)});a+=arrSFNotif.length;$(".val").text(a)}; 